function get_treated_element(i){var t={action:"wpdigi-dtrans-get-done-element",element:i};jQuery.post(ajaxurl,t,function(t){var e;for(e=0;e<t.transfert.length;e++)jQuery("#digi-datas-transfert-progression-container-"+t.transfert[e].type).html(t.transfert[e].text);t.auto_reload&&setTimeout(function(){get_treated_element(i)},"500")},"json")}jQuery(document).ready(function(i){digi_global.init(i),legal_display.init(i),digi_recommendation.init(!0,i),digi_risk.init(!0,i),digi_danger.init(!0,i),digi_epi.init(!0,i),digi_accident.init(!0,i),digi_chemical_product.init(!0,i),digi_search.event(i),digi_tools.event(i),digi_installer.event(i),digi_global.event(i),digi_evaluation_method.event(i),digi_evaluator.event(i),file_management.event(i),wpeo_gallery.event(i),digi_group.event(i),digi_society.event(i),digi_workunit.event(i),digi_tab.event(i),digi_user.event(i),digi_document.event(i),digi_user_dashboard.event(i),digi_user_detail.event(i),digi_corrective_task.event(i)});var digi_global={$:void 0,init:function(i){digi_global.$=i,digi_global.$(".wpdigi_date").datepicker({dateFormat:"dd/mm/yy"})},event:function(){digi_global.$(document).on("click","toggle, .digi-toggle",function(i){i.stopPropagation();var t,e=digi_global.$(this),n=digi_global.$(this).data("parent");t=void 0!==n?digi_global.$(this).closest("."+n).find("."+digi_global.$(this).data("target")):digi_global.$(this).parent().find("."+digi_global.$(this).data("target")),digi_global.$(".digi-popup").each(function(){0===digi_global.$(this).has(i.target).length&&digi_global.$(this).is(":visible")&&!digi_global.$(this).hasClass(e.data("target"))&&digi_global.$(this).hide()}),t.toggle()}),digi_global.$(document).on("click",function(i){digi_global.$(".digi-popup").each(function(){0===digi_global.$(this).has(i.target).length&&digi_global.$(this).is(":visible")&&digi_global.$(this).toggle()})})},responsive_menu_toggle:function(i){digi_global.$(".wp-digi-sheet-tab-responsive-content").toggle("fast"),digi_global.$(".wp-digi-sheet-tab-title").toggleClass("active")},download_file:function(i,t){var e=digi_global.$('<a href="'+i+'" download="'+t+'"></a>');digi_global.$(".wrap").append(e),e[0].click(),e.remove()},remove_diacritics:function(i){for(var t="",e=i.normalize("NFD"),n=0,o=0;n<i.length;)t+=e[o],o+=i[n]==e[o]?1:2,n++;return t}},regex={validateEmail:function(i){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(i)}},digi_accident={$:void 0,init:function(i,t){digi_accident.$=t,(i||void 0===i)&&digi_accident.event()},event:function(){digi_accident.$(document).on("click",".form-accident .wp-digi-action-new",function(i){digi_accident.edit_accident(i,digi_accident.$(this))}),digi_accident.$(document).on("click",".wp-digi-accident .wp-digi-action-delete",function(i){digi_accident.delete_accident(i,digi_accident.$(this))}),digi_accident.$(document).on("click",".wp-digi-accident .wp-digi-action-load",function(i){digi_accident.load_accident(i,digi_accident.$(this))})},edit_accident:function(i,t){digi_accident.$(t).closest("form").ajaxSubmit({beforeSubmit:function(){digi_accident.$(".wp-digi-content").addClass("wp-digi-bloc-loading")},success:function(i){digi_accident.$(".wp-digi-content").removeClass("wp-digi-bloc-loading"),digi_accident.$(".wp-digi-accident.wp-digi-list").replaceWith(i.data.template)}})},delete_accident:function(i,t){if(i.preventDefault(),window.confirm(window.digi_confirm_delete)){var e=digi_accident.$(t).data("id");digi_accident.$(".wp-digi-content").addClass("wp-digi-bloc-loading");var n={action:"wpdigi-delete-accident",_wpnonce:digi_accident.$(t).data("nonce"),global:digi_accident.$(t).data("global"),accident_id:e};digi_accident.$.post(window.ajaxurl,n,function(){digi_accident.$(".wp-digi-content").removeClass("wp-digi-bloc-loading"),digi_accident.$('.wp-digi-list .wp-digi-list-item[data-accident-id="'+e+'"]').fadeOut()})}},load_accident:function(i,t){i.preventDefault(),digi_accident.send_accident();var e=digi_accident.$(t).data("id");digi_accident.$(".wp-digi-content").addClass("wp-digi-bloc-loading");var n={action:"load_accident",_wpnonce:digi_accident.$(t).data("nonce"),accident_id:e};digi_accident.$.post(window.ajaxurl,n,function(i){digi_accident.$(".wp-digi-list-item .dashicons-edit").hide(),digi_accident.$(".wp-digi-content").removeClass("wp-digi-bloc-loading"),digi_accident.$('.wp-digi-accident .wp-digi-list-item[data-accident-id="'+e+'"]').replaceWith(i.data.template)})},send_accident:function(){digi_accident.$(".wp-digi-table-item-edit").each(function(){digi_accident.$(this).find(".dashicons-edit").click()})}},digi_chemical_product={$:void 0,init:function(i,t){digi_chemical_product.$=t,(i||void 0===i)&&digi_chemical_product.event()},event:function(){digi_chemical_product.$(document).on("click",".form-chemical-product .wp-digi-action-new",function(i){digi_chemical_product.edit_chemical_product(i,digi_chemical_product.$(this))}),digi_chemical_product.$(document).on("click",".wp-digi-chemical-product .wp-digi-action-delete",function(i){digi_chemical_product.delete_chemical_product(i,digi_chemical_product.$(this))}),digi_chemical_product.$(document).on("click",".wp-digi-chemical-product .wp-digi-action-load",function(i){digi_chemical_product.load_chemical_product(i,digi_chemical_product.$(this))})},edit_chemical_product:function(i,t){digi_chemical_product.$(t).closest("form").ajaxSubmit({beforeSubmit:function(){digi_chemical_product.$(".wp-digi-content").addClass("wp-digi-bloc-loading")},success:function(i){digi_chemical_product.$(".wp-digi-content").removeClass("wp-digi-bloc-loading"),digi_chemical_product.$(".wp-digi-chemical-product.wp-digi-list").replaceWith(i.data.template)}})},delete_chemical_product:function(i,t){if(i.preventDefault(),window.confirm(window.digi_confirm_delete)){var e=digi_chemical_product.$(t).data("id");digi_chemical_product.$(".wp-digi-content").addClass("wp-digi-bloc-loading");var n={action:"wpdigi-delete-chemical_product",_wpnonce:digi_chemical_product.$(t).data("nonce"),global:digi_chemical_product.$(t).data("global"),chemical_product_id:e};digi_chemical_product.$.post(window.ajaxurl,n,function(){digi_chemical_product.$(".wp-digi-content").removeClass("wp-digi-bloc-loading"),digi_chemical_product.$('.wp-digi-list .wp-digi-list-item[data-chemical-product-id="'+e+'"]').fadeOut()})}},load_chemical_product:function(i,t){i.preventDefault(),digi_chemical_product.send_chemical_product();var e=digi_chemical_product.$(t).data("id");digi_chemical_product.$(".wp-digi-content").addClass("wp-digi-bloc-loading");var n={action:"load_chemical_product",_wpnonce:digi_chemical_product.$(t).data("nonce"),chemical_product_id:e};digi_chemical_product.$.post(window.ajaxurl,n,function(i){digi_chemical_product.$(".wp-digi-list-item .dashicons-edit").hide(),digi_chemical_product.$(".wp-digi-content").removeClass("wp-digi-bloc-loading"),digi_chemical_product.$('.wp-digi-chemical-product .wp-digi-list-item[data-chemical-product-id="'+e+'"]').replaceWith(i.data.template)})},send_chemical_product:function(){digi_chemical_product.$(".wp-digi-table-item-edit").each(function(){digi_chemical_product.$(this).find(".dashicons-edit").click()})}},digi_corrective_task={$:void 0,event:function(i){},open_task:function(i,t){}},digi_danger={old_danger:void 0,$:void 0,init:function(i,t){digi_danger.$=t,(i||void 0===i)&&digi_danger.event(),this.old_danger=digi_danger.$(".wp-digi-risk-item-new toggle").html()},event:function(i){digi_danger.$(document).on("click",".form-risk .wp-digi-select-list li",function(i){digi_danger.select_danger(i,digi_danger.$(this))})},select_danger:function(i,t){digi_danger.$(".form-risk input.input-hidden-danger").val(digi_danger.$(t).data("id")),digi_danger.$(".form-risk toggle span").html(digi_danger.$(t).find("img").attr("title"))},reset_create_form:function(){digi_danger.$(".form-risk toggle").html(digi_danger.old_danger),digi_danger.$(".form-risk input.input-hidden-danger").val("")}},digi_document={$:void 0,event:function(i){digi_document.$=i,digi_document.$(".wp-digi-societytree-right-container").on("click","#wpdigi-save-element-sheet",function(i){digi_document.save_element_sheet(i,digi_document.$(this))}),digi_document.$(".wp-digi-societytree-right-container").on("click",".wp-digi-list-document .wp-digi-action-delete",function(i){digi_document.delete_element_sheet(i,digi_document.$(this))}),digi_document.$(".wp-digi-societytree-right-container").on("click",".wp-digi-list-document .wp-digi-action-regenerate",function(i){digi_document.regenerate_document(i,digi_document.$(this))}),digi_document.$(document).on("click",".wp-digi-doc-pagination a",function(i){digi_document.pagination(i,digi_document.$(this))})},regenerate_document:function(i,t){i.preventDefault();var e={action:"wpdigi_regenerate_document",element_id:digi_document.$(t).data("id"),parent_id:digi_document.$(t).data("parent-id"),model_name:digi_document.$(t).data("model"),_wpnonce:digi_document.$(t).data("nonce")};digi_document.$.post(window.ajaxurl,e,function(){})},delete_element_sheet:function(i,t){i.preventDefault();var e={action:"wpdigi_delete_sheet",parent_id:digi_document.$(t).data("parent-id"),element_id:digi_document.$(t).data("id"),global:digi_document.$(t).data("global")};digi_document.$(t).closest("li").fadeOut(),digi_document.$.post(window.ajaxurl,e,function(){})},save_element_sheet:function(i,t){i.preventDefault();var e={beforeSubmit:function(i,e,n){digi_document.$(t).addClass("wp-digi-loading")},success:function(i,e,n,o){digi_document.$(t).removeClass("wp-digi-loading"),i.success&&(void 0!==digi_document.$(".wp-digi-global-sheet-content ul.wp-digi-list-document").html()?digi_document.$(".wp-digi-global-sheet-content ul.wp-digi-list-document").prepend(i.data.output):digi_document.$(".wp-digi-global-sheet-tab li.wp-digi-sheet-generation-button").click())},dataType:"json",resetForm:!0};digi_document.$("#wpdigi-save-element-form").ajaxSubmit(e)},pagination:function(i,t){i.preventDefault();var e=digi_evaluator.$(t).attr("href").split("&"),n=e[1].replace("current_page=",""),o=e[2].replace("element_id=",""),a={action:"paginate_document",element_id:o,next_page:n};digi_evaluator.$.post(window.ajaxurl,a,function(i){digi_evaluator.$(".doc-content").replaceWith(i)})}},digi_epi={$:void 0,init:function(i,t){digi_epi.$=t,(i||void 0===i)&&digi_epi.event()},event:function(){digi_epi.$(document).on("click",".form-epi .wp-digi-action-new",function(i){digi_epi.edit_epi(i,digi_epi.$(this))}),digi_epi.$(document).on("click",".wp-digi-epi .wp-digi-action-delete",function(i){digi_epi.delete_epi(i,digi_epi.$(this))}),digi_epi.$(document).on("click",".wp-digi-epi .wp-digi-action-load",function(i){digi_epi.load_epi(i,digi_epi.$(this))})},edit_epi:function(i,t){digi_epi.$(t).closest("form").ajaxSubmit({beforeSubmit:function(){digi_epi.$(".wp-digi-content").addClass("wp-digi-bloc-loading")},success:function(i){digi_epi.$(".wp-digi-content").removeClass("wp-digi-bloc-loading"),digi_epi.$(".wp-digi-epi.wp-digi-list").replaceWith(i.data.template)}})},delete_epi:function(i,t){if(i.preventDefault(),window.confirm(window.digi_confirm_delete)){var e=digi_epi.$(t).data("id");digi_epi.$(".wp-digi-content").addClass("wp-digi-bloc-loading");var n={action:"wpdigi-delete-epi",_wpnonce:digi_epi.$(t).data("nonce"),global:digi_epi.$(t).data("global"),epi_id:e};digi_epi.$.post(window.ajaxurl,n,function(){digi_epi.$(".wp-digi-content").removeClass("wp-digi-bloc-loading"),digi_epi.$('.wp-digi-list .wp-digi-list-item[data-epi-id="'+e+'"]').fadeOut()})}},load_epi:function(i,t){i.preventDefault(),digi_epi.send_epi();var e=digi_epi.$(t).data("id");digi_epi.$(".wp-digi-content").addClass("wp-digi-bloc-loading");var n={action:"load_epi",_wpnonce:digi_epi.$(t).data("nonce"),epi_id:e};digi_epi.$.post(window.ajaxurl,n,function(i){digi_epi.$(".wp-digi-list-item .dashicons-edit").hide(),digi_epi.$(".wp-digi-content").removeClass("wp-digi-bloc-loading"),digi_epi.$('.wp-digi-epi .wp-digi-list-item[data-epi-id="'+e+'"]').replaceWith(i.data.template)})},send_epi:function(){digi_epi.$(".wp-digi-table-item-edit").each(function(){digi_epi.$(this).find(".dashicons-edit").click()})}},digi_evaluation_method={$:void 0,event:function(i){digi_evaluation_method.$=i,digi_evaluation_method.$(document).on("keyup",function(i){digi_evaluation_method.keyup(i,digi_evaluation_method.$(this))}),digi_evaluation_method.$(document).on("click","ul.wp-digi-risk-cotation-chooser li",function(i){digi_evaluation_method.select_cotation(i,digi_evaluation_method.$(this))}),digi_evaluation_method.$(document).on("click",".wpdigi-method-evaluation-render .row li",function(i){digi_evaluation_method.select_variable(i,digi_evaluation_method.$(this))}),digi_evaluation_method.$(document).on("click",".wpdigi-method-evaluation-render .wp-digi-bton-fourth",function(i){digi_evaluation_method.close_modal(digi_evaluation_method.$(this))}),digi_evaluation_method.$(document).on("click",".wpdigi-method-evaluation-render .dashicons-no-alt",function(i){digi_evaluation_method.close_modal(digi_evaluation_method.$(".wpdigi-method-evaluation-render .wp-digi-bton-fourth").click())}),digi_evaluation_method.$(document).on("click",".wp-digi-eval-evarisk",function(i){digi_evaluation_method.close_model_mask(i)})},keyup:function(i,t){27==i.keyCode&&digi_evaluation_method.$(".wpdigi-method-evaluation-render .dashicons-no-alt").click()},select_cotation:function(i,t){i.preventDefault();var e=digi_evaluation_method.$(t).closest("span"),n=digi_evaluation_method.$(t).attr("data-level"),o=digi_evaluation_method.$(t).closest(".wp-digi-list-item").find("input.digi-method-simple").val(),a=e.find("div"),s=a[0];s.className=s.className.replace(/wp-digi-risk-level-[0-4]/,"wp-digi-risk-level-"+n),a.html(digi_evaluation_method.$(t).text()),digi_evaluation_method.$(t).closest("form").find(".risk-level").val(n),digi_evaluation_method.$(t).closest(".wp-digi-list-item").find("input.input-hidden-method-id").val(o)},select_variable:function(i,t){"undefined"!=digi_evaluation_method.$(t).data("seuil-id")&&(digi_evaluation_method.$('.wpdigi-method-evaluation-render .row li[data-variable-id="'+digi_evaluation_method.$(t).data("variable-id")+'"]').removeClass("active"),digi_evaluation_method.$(t).addClass("active"),digi_evaluation_method.$(".wpdigi-method-evaluation-render input.variable-"+digi_evaluation_method.$(t).data("variable-id")).val(digi_evaluation_method.$(t).data("seuil-id")))},close_modal:function(i){var t={},e=0;digi_evaluation_method.$(".wpdigi-method-evaluation-render .wp-digi-eval-evarisk:visible").find('input[type="hidden"]:not(.digi-method-evaluation-id)').each(function(i,n){t[digi_evaluation_method.$(n).attr("variable-id")]=digi_evaluation_method.$(n).val(),""!==digi_evaluation_method.$(n).val()&&e++});var n={action:"get_scale",_wpnonce:digi_evaluation_method.$(i).data("nonce"),list_variable:t};return 5===e?(digi_evaluation_method.$(i).addClass("wp-digi-loading"),digi_evaluation_method.$.post(window.ajaxurl,n,function(t){digi_evaluation_method.$(".wpdigi-method-evaluation-render").hide(),digi_evaluation_method.$(i).closest(".wp-digi-list-item").find("input.input-hidden-method-id").val(digi_evaluation_method.$(i).closest(".wpdigi-method-evaluation-render").find("input.digi-method-evaluation-id").val()),digi_evaluation_method.$(i).closest(".wp-digi-list-item").find(".wp-digi-risk-level-new").html(t.data.equivalence),digi_evaluation_method.$(i).closest(".wp-digi-list-item").find(".wp-digi-risk-list-column-cotation > div").attr("class","wp-digi-risk-level-new wp-digi-risk-level-"+t.data.scale),digi_evaluation_method.$(i).closest(".wp-digi-list-item").find('input[name="risk_evaluation_level"]').val(t.data.scale),digi_evaluation_method.$(i).removeClass("wp-digi-loading")})):digi_evaluation_method.$(".wpdigi-method-evaluation-render").hide(),!1},close_model_mask:function(i){"wp-digi-eval-evarisk"===i.target.className&&digi_evaluation_method.$(".wpdigi-method-evaluation-render").hide()}},digi_evaluator={$:void 0,event:function(i){digi_evaluator.$=i,digi_evaluator.$(document).on("click",'.wp-digi-evaluator-list input[type="checkbox"]',function(){digi_evaluator.add_time(digi_evaluator.$(this))}),digi_evaluator.$(document).on("click",'.wp-form-evaluator-to-assign input[type="submit"]',function(i){digi_evaluator.add_evaluator(i,digi_evaluator.$(this))}),digi_evaluator.$(document).on("click",".wp-digi-list-evaluator .wp-digi-action-delete",function(i){digi_evaluator.delete_evaluator(i,digi_evaluator.$(this))}),digi_evaluator.$(document).on("click",".wp-form-evaluator-to-assign .wp-digi-pagination a",function(i){digi_evaluator.pagination(i,digi_evaluator.$(this))})},add_time:function(i){digi_evaluator.$(i).closest("li").find(".period-assign input").val(digi_evaluator.$('.wp-digi-evaluator-list .wp-digi-table-header input[type="text"]').val())},add_evaluator:function(i,t){i.preventDefault(),digi_evaluator.$(".wp-digi-list-evaluator").addClass("wp-digi-bloc-loading"),digi_evaluator.$(t).closest("form").ajaxSubmit(function(i){digi_evaluator.$(".wp-digi-list-evaluator").replaceWith(i.data.template)})},delete_evaluator:function(i,t){if(i.preventDefault(),window.confirm(window.digi_confirm_delete)){digi_evaluator.$(".wp-digi-list-evaluator").addClass("wp-digi-bloc-loading");var e={action:"detach_evaluator",id:digi_evaluator.$(t).data("id"),user_id:digi_evaluator.$(t).data("user-id"),global:digi_evaluator.$(t).data("global"),affectation_id:digi_evaluator.$(t).data("affectation-data-id")};digi_evaluator.$.post(window.ajaxurl,e,function(i){digi_evaluator.$(".wp-digi-list-evaluator").replaceWith(i.data.template)})}},pagination:function(i,t){i.preventDefault();var e=digi_evaluator.$(t).attr("href").split("&"),n=e[1].replace("current_page=",""),o=e[2].replace("element_id=",""),a={action:"paginate_evaluator",element_id:o,next_page:n};digi_evaluator.$(".wp-digi-content").load(window.ajaxurl,a,function(){})}},digi_export={$:void 0,init:function(i,t){digi_export.$=t,(i||void 0===i)&&digi_export.event()},event:function(){digi_export.$(document).on("submit","#digi-data-export #digi-export-form",function(i){digi_export.create_export(i,digi_export.$(this))}),digi_export.$(document).on("change",'#digi-data-export #digi-import-form input[type="file"]',function(i){digi_export.make_import(i,digi_export.$(this))})},create_export:function(i,t){i.preventDefault(),digi_export.$(t).closest("form").ajaxSubmit({beforeSubmit:function(){digi_export.$(t).closest(".wp-digi-bloc-loader").addClass("wp-digi-bloc-loading")},success:function(i){digi_export.$(t).closest(".wp-digi-bloc-loader").removeClass("wp-digi-bloc-loading"),window.digi_global.download_file(i.data.url_to_file,i.data.filename)}})},make_import:function(i,t){i.preventDefault();var e=new FormData;e.append("file",digi_export.$(t)[0].files[0]),e.append("action","digi_import_data"),e.append("_wpnonce",digi_export.$(t).closest("form").find('input[name="_wpnonce"]').val()),e.append("index_element",0),digi_export.request_import(e)},request_import:function(i){digi_export.$.ajax({url:ajaxurl,data:i,processData:!1,contentType:!1,type:"POST",beforeSend:function(){digi_export.$(".digi-import-detail").html(window.digi_tools_in_progress)},success:function(i){if(i.success)if(digi_export.$("progress").attr("max",i.data.count_element),digi_export.$("progress").val(i.data.index_element/i.data.count_element*i.data.count_element),i.data.end)digi_export.$(".digi-import-detail").html(window.digi_tools_done),digi_export.$("#toplevel_page_digi-setup a").attr("href",digi_export.$("#toplevel_page_digi-setup a").attr("href"))&&digi_export.$("#toplevel_page_digi-setup a").attr("href",digi_export.$("#toplevel_page_digi-setup a").attr("href").replace("digi-setup","digirisk-simple-risk-evaluation"));else{var t=new FormData;t.append("action","digi_import_data"),t.append("_wpnonce",digi_export.$("#digi-import-form").find('input[name="_wpnonce"]').val()),t.append("path_to_json",i.data.path_to_json),t.append("index_element",i.data.index_element),digi_export.$(".digi-import-detail").html(window.digi_tools_in_progress),digi_export.request_import(t)}else alert("Problème lors de l'importation du modèle"),digi_installer.$("#digi-data-export").removeClass("wp-digi-bloc-loading")}})}};jQuery(document).ready(function(i){digi_export.init(!0,i)});var file_management={file_frame:void 0,element_id:void 0,have_thumbnail:void 0,object_name:void 0,_wpnonce:void 0,$:void 0,event:function(i){file_management.$=i,file_management.$(document).on("click","span.wpeo-upload-media, a.wpeo-upload-media",function(i){file_management.open_popup(i,file_management.$(this))})},open_popup:function(i,t){i.preventDefault(),file_management.element_id=file_management.$(t).data("id"),file_management._wpnonce=file_management.$(t).data("nonce"),file_management.object_name=file_management.$(t).data("object-name"),file_management.have_thumbnail=!!file_management.$(t).hasClass("wp-digi-element-thumbnail"),window.wp.media.model.settings.post.id=file_management.$(t).data("id"),0===file_management.$(t).find(".wpeo-gallery").length?file_management.load_media_upload(t,file_management.$(t).data("id")):window.wpeo_gallery.open(t)},load_media_upload:function(i,t){file_management.file_frame=new window.wp.media.view.MediaFrame.Post({title:file_management.$(i).data("uploader_title"),button:{text:file_management.$(i).data("uploader_button_text")},multiple:!1}),file_management.file_frame.el.className+=" digi-upload-"+t,file_management.file_frame.on("insert",function(){file_management.selected_file(i)}),file_management.open_media_upload()},open_media_upload:function(){file_management.file_frame.open()},selected_file:function(i){var t,e,n=file_management.file_frame.state().get("selection");n.map(function(i){t=i.toJSON(),e=i.id}),0===file_management.element_id?file_management.display_attachment(t,i):file_management.associate_file(e)},display_attachment:function(i,t){file_management.$(t).find("img").attr("src",i.url).show(),file_management.$(t).find("i").hide(),file_management.$(t).find("input.input-file-image").val(i.id)},associate_file:function(i){file_management.$('span.wpeo-upload-media[data-id="'+file_management.element_id+'"]').addClass("wp-digi-bloc-loading");var t={action:"eo_associate_file",file_id:i,_wpnonce:file_management._wpnonce,element_id:file_management.element_id,object_name:file_management.object_name,thumbnail:file_management.have_thumbnail};file_management.$.post(window.ajaxurl,t,function(i){file_management.$('span.wpeo-upload-media[data-id="'+file_management.element_id+'"]').replaceWith(i.data.template)})}},wpeo_gallery={$:void 0,event:function(i){wpeo_gallery.$=i,wpeo_gallery.$(document).on("keyup",function(i){wpeo_gallery.keyup(i,wpeo_gallery.$(this))}),wpeo_gallery.$(document).on("click",".wpeo-gallery",function(i){return i.preventDefault(),!1}),wpeo_gallery.$(document).on("click",".wpeo-gallery .prev",function(i){wpeo_gallery.prev(i,wpeo_gallery.$(this))}),wpeo_gallery.$(document).on("click",".wpeo-gallery .next",function(i){wpeo_gallery.next(i,wpeo_gallery.$(this))}),wpeo_gallery.$(document).on("click",".wpeo-gallery .set-as-thumbnail",function(i){wpeo_gallery.set_thumbnail(i,wpeo_gallery.$(this))}),wpeo_gallery.$(document).on("click",".wpeo-gallery .close",function(i){wpeo_gallery.close(i)})},keyup:function(i,t){37==i.keyCode?wpeo_gallery.$(".wpeo-gallery .prev").click():39==i.keyCode?wpeo_gallery.$(".wpeo-gallery .next").click():27==i.keyCode&&wpeo_gallery.$(".wpeo-gallery .close").click()},open:function(i){wpeo_gallery.$(i).find(".wpeo-gallery").show()},prev:function(i,t){i.preventDefault(),wpeo_gallery.$(t).closest("div").find(".image-list li.current").prev().length<=0?(wpeo_gallery.$(t).closest("div").find(".image-list li.current").toggleClass("current hidden"),wpeo_gallery.$(t).closest("div").find(".image-list li:last").toggleClass("hidden current")):wpeo_gallery.$(t).closest("div").find(".image-list li.current").toggleClass("current hidden").prev().toggleClass("hidden current")},next:function(i,t){i.preventDefault(),wpeo_gallery.$(t).closest("div").find(".image-list li.current").next().length<=0?(wpeo_gallery.$(t).closest("div").find(".image-list li.current").toggleClass("current hidden"),wpeo_gallery.$(t).closest("div").find(".image-list li:first").toggleClass("hidden current")):wpeo_gallery.$(t).closest("div").find(".image-list li.current").toggleClass("current hidden").next().toggleClass("hidden current")},set_thumbnail:function(i,t){var e={action:"eo_set_thumbnail",element_id:wpeo_gallery.$(t).closest("div").data("id"),thumbnail_id:wpeo_gallery.$(t).closest("div").find("li.current").data("id")};wpeo_gallery.$.post(window.ajaxurl,e,function(i){wpeo_gallery.$('span.wpeo-upload-media[data-id="'+window.file_management.element_id+'"]').find(".wp-post-image").replaceWith(i.data.template)})},close:function(i){wpeo_gallery.$(".wpeo-gallery").hide()}},digi_group={$:void 0,event:function(i){digi_group.$=i,digi_group.$(document).on("keyup",'input[name="wp-digi-group-name"]',function(i){digi_group.identity_edition_mode(i,digi_group.$(this))}),digi_group.$(document).on("click","#wp-digi-save-group-identity-button",function(i){digi_group.save_identity(i,digi_group.$(this))}),digi_group.$(document).on("click",".wp-digi-group-selector .wp-digi-new-group-action a",function(i){digi_group.create_group(i,digi_group.$(this))}),digi_group.$(document).on("click",".wp-digi-duer-form-display",function(i){digi_group.display_form_duer(i,digi_group.$(this))}),digi_group.$(".wp-digi-societytree-right-container").on("click",".wp-digi-duer-generation-button",function(i){digi_group.save_element_sheet(i,digi_group.$(this))}),digi_group.$(document).on("click",".wp-digi-form-save-configuration button",function(i){digi_group.save_configuration(i,digi_group.$(this))})},identity_edition_mode:function(i,t){digi_group.$(".wp-digi-group-action-container").removeClass("hidden"),digi_group.$(t).addClass("active"),digi_group.$(".wp-digi-societytree-left-container toggle span").html(digi_group.$(t).val()),digi_group.$(".wp-digi-group-action-container .wp-digi-bton-fourth").text("Enregistrer")},save_identity:function(i,t){digi_group.$(t).addClass("wp-digi-loading");var e=digi_group.$(t).closest(".wp-digi-group-sheet").data("id"),n={action:"wpdigi_ajax_group_update",_wpnonce:digi_group.$(t).data("nonce"),group_id:e,send_to_group_id:digi_group.$('input[name="wp-digi-group-id"]').val(),title:digi_group.$('input[name="wp-digi-group-name"]').val()};digi_group.$.post(window.ajaxurl,n,function(i){digi_group.$(t).removeClass("wp-digi-loading"),digi_group.$(t).removeClass("active"),digi_group.$(t).closest(".wp-digi-group-sheet-header").find(".wpdigi-auto-complete").val(""),digi_group.$(t).closest(".wp-digi-group-sheet-header").find('input[name="wp-digi-group-id"]').val("0"),void 0!==i.data.template_left&&digi_group.$(".wp-digi-societytree-left-container").html(i.data.template_left),digi_group.$(".wp-digi-group-action-container").addClass("hidden")})},create_group:function(i,t){i.preventDefault();var e=digi_group.$(t).data("id");digi_group.$(".wp-digi-group-selector .wp-digi-develop-list").toggle(),digi_group.$(".wp-digi-societytree-main-container").addClass("wp-digi-bloc-loading");var n={action:"wpdigi-create-group",group_id:e};digi_group.$.post(window.ajaxurl,n,function(i){digi_group.$(".wp-digi-societytree-main-container").removeClass("wp-digi-bloc-loading"),digi_group.$(".wp-digi-societytree-left-container").replaceWith(i.data.template_left),digi_group.$(".wp-digi-societytree-right-container").html(i.data.template_right),window.digi_global.init(digi_group.$),window.digi_workunit.event(digi_society.$),window.digi_search.event(digi_group.$)})},display_form_duer:function(i,t){i.preventDefault(),digi_group.$(".wp-digi-societytree-right-container").addClass("wp-digi-bloc-loading");var e={action:"load_sheet_display",element_id:digi_group.$(t).data("id"),tab_to_display:"digi-generate-sheet"};digi_group.$.post(window.ajaxurl,e,function(i){digi_group.$(".wp-digi-societytree-right-container").html(i.data.template),digi_group.$(".wp-digi-societytree-right-container").removeClass("wp-digi-bloc-loading")})},save_element_sheet:function(i,t){i.preventDefault();var e={beforeSubmit:function(i,e,n){digi_group.$(t).addClass("wp-digi-loading")},success:function(i,e,n,o){digi_group.$(t).removeClass("wp-digi-loading"),digi_group.$(".wp-digi-global-sheet-tab li[data-action='digi-sheet']").click()},dataType:"json"};digi_group.$("#wpdigi-save-element-form").ajaxSubmit(e)},save_configuration:function(i,t){i.preventDefault(),digi_group.$(t).closest("form").ajaxSubmit({beforeSubmit:function(){digi_group.$(".wp-digi-societytree-main-container").addClass("wp-digi-bloc-loading")},success:function(){digi_group.$(".wp-digi-societytree-main-container").removeClass("wp-digi-bloc-loading")}})}},digi_installer={$:void 0,event:function(i){digi_installer.$=i,digi_installer.$(document).on("click",'.wpdigi-installer form input[type="button"]',function(){digi_installer.form_groupement(digi_installer.$(this))}),digi_installer.$(document).on("click",".wpdigi-installer .btn-more-option",function(i){digi_installer.toggle_form(i,digi_installer.$(this))})},form_groupement:function(i){digi_installer.$(i).closest("form").ajaxSubmit({beforeSubmit:function(){return""===digi_installer.$('.wpdigi-installer input[name="groupement[title]"]').val()?(digi_installer.$('.wpdigi-installer input[name="groupement[title]"]').css("border-bottom","solid red 2px"),!1):(digi_installer.$(i).closest("div").addClass("wp-digi-bloc-loading"),void digi_installer.$('.wpdigi-installer input[name="groupement[title]"]').css("border-bottom","2px solid #272a35"))},success:function(t){digi_installer.$(i).closest("div").hide(),digi_installer.$(".wpdigi-installer .wpdigi-staff").fadeIn(),digi_installer.$(".wpdigi-installer ul.step li:first").removeClass("active"),digi_installer.$(".wpdigi-installer ul.step li:last").addClass("active"),digi_installer.$("#toplevel_page_digi-setup a").attr("href",digi_installer.$("#toplevel_page_digi-setup a").attr("href").replace("digi-setup","digirisk-simple-risk-evaluation"))}})},save_last_step:function(i,t){digi_installer.$(".wpdigi-installer .dashicons-plus:last").click()},toggle_form:function(i,t){i.preventDefault(),digi_installer.$(t).find(".dashicons").toggleClass("dashicons-plus dashicons-minus"),digi_installer.$(t).closest("form").find(".form-more-option").toggle()}},legal_display={$:void 0,init:function(i){legal_display.$=i,legal_display.init_form()},init_form:function(){var i={beforeSubmit:function(i,t,e){legal_display.$(".form-legal-display .generate-legal-display").addClass("wp-digi-loading")},success:function(i,t,e,n){legal_display.$(".form-legal-display .generate-legal-display").removeClass("wp-digi-loading"),legal_display.$('.wp-digi-global-sheet-tab li[data-action="digi-sheet"]').click()}};legal_display.$(document).on("click",".form-legal-display button",function(){return legal_display.$(this).closest("form").ajaxSubmit(i),!1})}},digi_recommendation={old_recommendation_name:void 0,old_thumbnail:void 0,$:void 0,init:function(i,t){digi_recommendation.$=t,digi_recommendation.old_recommendation_name=digi_recommendation.$(".wp-digi-recommendation-item-new toggle").html(),digi_recommendation.old_thumbnail=digi_recommendation.$(".wp-digi-recommendation-item-new .wp-digi-recommendation-thumbnail").html(),(i||void 0===i)&&digi_recommendation.event()},event:function(){digi_recommendation.$(document).on("click",".wp-digi-recommendation-item-new .wp-digi-select-list li",function(i){digi_recommendation.select_recommendation(i,digi_recommendation.$(this))}),digi_recommendation.$(document).on("click",".wp-digi-recommendation-item-new .dashicons-plus",function(i){digi_recommendation.add_recommendation(i,digi_recommendation.$(this))}),digi_recommendation.$(document).on("click",".wp-digi-recommendation-item .wp-digi-action-load",function(i){digi_recommendation.load_recommendation(i,digi_recommendation.$(this));
}),digi_recommendation.$(document).on("click",".wp-digi-recommendation-item .wp-digi-action-edit",function(i){digi_recommendation.edit_recommendation(i,digi_recommendation.$(this))}),digi_recommendation.$(document).on("click",".wp-digi-recommendation-item .wp-digi-action-delete",function(i){digi_recommendation.delete_recommendation(i,digi_recommendation.$(this))})},select_recommendation:function(i,t){digi_recommendation.$(".wp-digi-recommendation-item-new input[name=recommendation_id]").val(digi_recommendation.$(t).data("id")),digi_recommendation.$(".wp-digi-recommendation-item-new .wp-digi-select-list").toggle(),digi_recommendation.$(".wp-digi-recommendation-item-new .wp-digi-recommendation-thumbnail i").hide(),digi_recommendation.$(".wp-digi-recommendation-item-new toggle").html(digi_recommendation.$(t).data("name")),digi_recommendation.$(".wp-digi-recommendation-item-new .wp-digi-recommendation-thumbnail .attachment-digirisk-element-miniature").attr("src",digi_recommendation.$(t).data("url")).show()},add_recommendation:function(i,t){i.preventDefault(),digi_recommendation.$(".wp-digi-recommendation-item-new").addClass("wp-digi-bloc-loading"),digi_recommendation.$(t).closest("form").ajaxSubmit({success:function(i){digi_recommendation.$(".wp-digi-recommendation-item-new").removeClass("wp-digi-bloc-loading"),digi_recommendation.$(".wp-digi-recommendation.wp-digi-list").append(i.data.template),digi_recommendation.$(".wp-digi-recommendation-item-new toggle").html(digi_recommendation.old_recommendation_name),digi_recommendation.$('.wp-digi-recommendation-item-new input[name="recommendation_id"]').val(""),digi_recommendation.$('.wp-digi-recommendation-item-new input[name="recommendation_comment"]').val(""),digi_recommendation.$(".wp-digi-recommendation-item-new .wp-digi-recommendation-thumbnail").html(digi_recommendation.old_thumbnail)}})},load_recommendation:function(i,t){i.preventDefault();var e={action:"wpdigi-load-recommendation",_wpnonce:digi_recommendation.$(t).data("nonce"),workunit_id:digi_recommendation.$(t).data("workunit-id"),term_id:digi_recommendation.$(t).data("id"),index:digi_recommendation.$(t).data("index")};digi_recommendation.$.post(window.ajaxurl,e,function(i){digi_recommendation.$(t).closest(".wp-digi-recommendation-item").replaceWith(i.data.template)})},edit_recommendation:function(i,t){digi_recommendation.$(t).closest(".wp-digi-recommendation-item").addClass("wp-digi-bloc-loading"),digi_recommendation.$(t).closest("form").ajaxSubmit({success:function(i){digi_recommendation.$(t).closest(".wp-digi-recommendation-item").replaceWith(i.data.template)}})},delete_recommendation:function(i,t){if(i.preventDefault(),window.confirm(window.digi_confirm_delete)){var e=digi_recommendation.$(t).data("workunit-id"),n=digi_recommendation.$(t).data("id"),o=digi_recommendation.$(t).data("index"),a=digi_recommendation.$(t).data("nonce"),s={action:"wpdigi-delete-recommendation",_wpnonce:a,workunit_id:e,term_id:n,index:o};digi_recommendation.$(t).closest(".wp-digi-recommendation-item").fadeOut(),digi_recommendation.$.post(window.ajaxurl,s,function(){})}}},digi_risk_comment={$:void 0,event:function(i){digi_risk_comment.$=i,digi_risk_comment.$(document).on("click",".wp-digi-action-comment-delete",function(i){digi_risk_comment.delete_comment(i,digi_risk_comment.$(this))})},delete_comment:function(i,t){if(window.confirm(window.digi_confirm_delete)){var e={action:"delete_comment",_wpnonce:digi_risk_comment.$(t).data("nonce"),risk_id:digi_risk_comment.$(t).data("risk-id"),id:digi_risk_comment.$(t).data("id")};digi_risk_comment.$(t).closest("li").remove(),digi_risk_comment.$.post(window.ajaxurl,e,function(){})}},reset_create_form:function(){digi_risk_comment.$(".wp-digi-risk-item-new .wp-digi-risk-comment textarea").val("")}},digi_risk={old_date:void 0,button:void 0,old_cotation:void 0,$:void 0,init:function(i,t){digi_risk.$=t,(i||void 0===i)&&(window.digi_risk_comment.event(digi_risk.$),window.digi_danger.init(i,digi_risk.$),digi_risk.event()),this.old_date=digi_risk.$('.wp-digi-risk-item-new input[name="risk_comment_date"]').val(),this.old_cotation=digi_risk.$(".wp-digi-risk-item-new .wp-digi-risk-level-new").html()},event:function(){digi_risk.$(document).on("click",".wp-digi-risk-item-new .wp-digi-action-new",function(i){digi_risk.create_risk(i,digi_risk.$(this))}),digi_risk.$(document).on("click",".wp-digi-risk .wp-digi-action-delete",function(i){digi_risk.delete_risk(i,digi_risk.$(this))}),digi_risk.$(document).on("click",".wp-digi-risk .wp-digi-action-load",function(i){digi_risk.load_risk(i,digi_risk.$(this))}),digi_risk.$(document).on("click",".wp-digi-risk .wp-digi-action-edit",function(i){digi_risk.edit_risk(i,digi_risk.$(this))})},create_risk:function(i,t){return digi_risk.$(t).closest("form").ajaxSubmit({beforeSubmit:function(){var i=!1;return"0"===digi_risk.$(t).closest("form").find('input[name="method_evaluation_id"]').val()&&(digi_risk.$(t).closest("form").find(".wp-digi-risk-list-column-cotation").css("border","solid red 2px"),i=!0),""===digi_risk.$(t).closest("form").find('input[name="danger_id"]').val()&&(digi_risk.$(t).closest("form").find(".wp-digi-summon-list").css("border","solid red 2px"),i=!0),digi_risk.$(t).closest("form").find('input[name="list_comment[0][comment_date]"]').val()||(digi_risk.$(t).closest("form").find('input[name="list_comment[0][comment_date]"]').css("border","solid red 2px"),i=!0),!i&&(digi_risk.$(t).closest("form").find(".wp-digi-risk-list-column-cotation").css("border","none"),digi_risk.$(t).closest("form").find(".wp-digi-summon-list").css("border","1px solid rgba(0,0,0,.2)"),digi_risk.$(t).closest("form").find('input[name="risk_comment_date"]').css("border","none"),void digi_risk.$(".wp-digi-content").addClass("wp-digi-bloc-loading"))},success:function(i){digi_risk.$(".wp-digi-content").removeClass("wp-digi-bloc-loading"),digi_risk.$(".wp-digi-content > :first-child").replaceWith(i.data.template),digi_risk.reset_create_form()}}),!1},delete_risk:function(i,t){if(i.preventDefault(),window.confirm(window.digi_confirm_delete)){var e=digi_risk.$(t).data("id");digi_risk.$(".wp-digi-content").addClass("wp-digi-bloc-loading");var n={action:"wpdigi-delete-risk",_wpnonce:digi_risk.$(t).data("nonce"),global:digi_risk.$(t).data("global"),risk_id:e};digi_risk.$.post(window.ajaxurl,n,function(){digi_risk.$(".wp-digi-content").removeClass("wp-digi-bloc-loading"),digi_risk.$('.wp-digi-list .wp-digi-list-item[data-risk-id="'+e+'"]').fadeOut()})}},load_risk:function(i,t){i.preventDefault(),digi_risk.send_risk();var e=digi_risk.$(t).data("id");digi_risk.$(".wp-digi-content").addClass("wp-digi-bloc-loading");var n={action:"wpdigi-load-risk",_wpnonce:digi_risk.$(t).data("nonce"),global:digi_risk.$(t).data("global"),risk_id:e};digi_risk.$.post(window.ajaxurl,n,function(i){digi_risk.$(".wp-digi-list-item .dashicons-edit").hide(),digi_risk.$(".wp-digi-content").removeClass("wp-digi-bloc-loading"),digi_risk.$('.wp-digi-risk .wp-digi-list-item[data-risk-id="'+e+'"]').replaceWith(i.data.template),digi_risk.$('.wp-digi-risk .wp-digi-list-item[data-risk-id="'+e+'"] .wpdigi-method-evaluation-render').html(i.data.table_evaluation_method),digi_risk.$(".wpdigi_date").datepicker({dateFormat:"dd/mm/yy"})})},edit_risk:function(i,t){i.preventDefault();digi_risk.$(t).data("id");digi_risk.$(".wp-digi-content").addClass("wp-digi-bloc-loading"),digi_risk.$(t).closest("form").ajaxSubmit({success:function(i){digi_risk.$(".wp-digi-content").removeClass("wp-digi-bloc-loading"),digi_risk.$(".wp-digi-list-item .dashicons-edit").show(),digi_risk.$(".wp-digi-content > :first-child").replaceWith(i.data.template)}})},send_risk:function(){digi_risk.$(".wp-digi-table-item-edit").each(function(){digi_risk.$(this).find(".dashicons-edit").click()})},reset_create_form:function(){digi_risk.$(".wp-digi-risk-item-new .wp-digi-risk-level-new").html(digi_risk.old_cotation);var i=digi_risk.$(".wp-digi-risk-item-new .wp-digi-risk-list-column-cotation div")[0];i.className=i.className.replace(/wp-digi-risk-level-[0-4]/,"wp-digi-risk-level-0"),digi_risk.$('.wp-digi-risk-item-new input[name="risk_evaluation_level"]').val(""),digi_risk.$('.wp-digi-risk-item-new input[name="method_evaluation_id"]').val("0"),window.digi_risk_comment.reset_create_form(),window.digi_danger.reset_create_form()}},digi_search={$:void 0,event:function(i){digi_search.$=i,digi_search.$.each(digi_search.$(".wp-list-search input"),function(i,t){var e={source:"admin-ajax.php?action=digi_search&next_action="+digi_search.$(t).data("next-action")+"&class="+digi_search.$(t).data("class")+"&id="+digi_search.$(t).data("id")+"&type="+digi_search.$(t).data("type"),minLength:0};digi_search.$(t).data("target")&&(e.search=function(i,e){digi_search.$("."+digi_search.$(t).data("target")).addClass("wp-digi-bloc-loading")},e.response=function(i,e){digi_search.$("."+digi_search.$(t).data("target")).replaceWith(e.content[1].template)},e.open=function(i,e){digi_search.$(t).autocomplete("close")}),digi_search.$(t).data("field")&&(e.select=function(i,e){digi_search.$('input[name="'+digi_search.$(t).data("field")+'"]').val(e.item.id),digi_global.$(".wp-digi-group-action-container").removeClass("hidden"),digi_global.$(".wp-digi-group-action-container .wp-digi-bton-fourth").text("Déplacer")}),digi_search.$(t).autocomplete(e)})}};jQuery(document).ready(function(){jQuery(document).unbind("keydown").bind("keydown",function(i){var t=!1;if(8===i.keyCode){var e=i.srcElement||i.target;t=("INPUT"!==e.tagName.toUpperCase()||"TEXT"!==e.type.toUpperCase()&&"PASSWORD"!==e.type.toUpperCase()&&"FILE"!==e.type.toUpperCase()&&"SEARCH"!==e.type.toUpperCase()&&"EMAIL"!==e.type.toUpperCase()&&"NUMBER"!==e.type.toUpperCase()&&"DATE"!==e.type.toUpperCase())&&"TEXTAREA"!==e.tagName.toUpperCase()||(e.readOnly||e.disabled)}t&&i.preventDefault()})});var digi_society={$:void 0,event:function(i){digi_society.$=i,digi_society.$(document).on("keyup",'input[name="establishment_name"]',function(i){digi_society.identity_edition_mode(i,digi_society.$(this))}),digi_society.$(document).on("click",".wp-digi-societytree-left-container .wp-digi-global-name",function(i){digi_society.load_society(i,digi_society.$(this))}),digi_society.$(document).on("click",".wp-digi-global-sheet-header button.wp-digi-save-identity-button",function(i){digi_society.save_society(i,digi_society.$(this))}),digi_society.$(document).on("click",".wp-digi-global-sheet-header .wp-digi-delete-action",function(i){digi_society.delete_society(i,digi_society.$(this))})},identity_edition_mode:function(i,t){digi_society.$(t).closest(".wp-digi-global-sheet-header").find(".wp-digi-global-action-container").removeClass("hidden"),digi_society.$(t).addClass("active"),digi_global.$(".wp-digi-group-action-container .wp-digi-bton-fourth").text("Enregistrer")},load_society:function(i,t){digi_society.$(".wp-digi-group-selector .digi-popup").hide(),digi_society.$(t).closest("ul").find("li.active").removeClass("active"),digi_society.$(t).closest("li").addClass("active"),digi_society.$(".wp-digi-societytree-right-container").addClass("wp-digi-bloc-loading"),digi_society.$(".wp-digi-societytree-left-container").addClass("wp-digi-bloc-loading");var e={action:"load_sheet_display",element_id:digi_society.$(t).closest("li").data("id"),tab_to_display:"digi-risk"};digi_society.$.post(window.ajaxurl,e,function(i){digi_society.$(".wp-digi-societytree-right-container").removeClass("wp-digi-bloc-loading"),digi_society.$(".wp-digi-societytree-right-container").html(i.data.template),digi_society.$(".wp-digi-societytree-left-container").removeClass("wp-digi-bloc-loading"),i.data.template_left&&digi_society.$(".wp-digi-societytree-left-container").replaceWith(i.data.template_left),window.digi_global.init(digi_society.$),window.digi_risk.init(!1,digi_society.$),window.digi_search.event(digi_society.$)})},save_society:function(i,t){digi_society.$(t).addClass("wp-digi-loading");var e=digi_society.$(t).closest(".wp-digi-sheet").data("id"),n={action:"save_society",id:e,parent_id:digi_society.$('input[name="group_id"]').val(),title:digi_society.$('input[name="establishment_name"]').val()};digi_society.$.post(window.ajaxurl,n,function(i){digi_society.$(".wp-digi-societytree-left-container").html(i.data.template_left),digi_society.$(t).removeClass("wp-digi-loading"),digi_society.$(".wp-digi-global-sheet-header .wp-digi-global-action-container").addClass("hidden"),digi_society.$(".wp-digi-global-sheet-header .wp-list-search input").val("")},"json")},delete_society:function(i,t){if(i.preventDefault(),window.confirm(window.digi_confirm_delete)){var e={action:"delete_society",element_id:digi_society.$(t).data("id")};digi_society.$(".wp-digi-societytree-main-container").addClass("wp-digi-bloc-loading"),digi_society.$.post(window.ajaxurl,e,function(i){digi_society.$(".wp-digi-societytree-main-container").removeClass("wp-digi-bloc-loading"),digi_society.$(".wp-digi-societytree-main-container").replaceWith(i.data.template)})}}},digi_tab={$:void 0,event:function(i){digi_tab.$=i,digi_tab.$(".wp-digi-societytree-right-container").on("click",".wp-digi-global-sheet-tab li",function(i){digi_tab.click_tab(i,digi_tab.$(this))})},click_tab:function(i,t){if(i.preventDefault(),!digi_tab.$(t).hasClass("disabled")){var e=digi_tab.$(t).data("action");digi_tab.$(".wp-digi-global-sheet-tab li.active").removeClass("active"),digi_tab.$(t).addClass("active"),digi_tab.$(".wp-digi-content").addClass("wp-digi-bloc-loading");var n={action:"load_tab_content",_wpnonce:digi_tab.$(t).data("nonce"),tab_to_display:e,element_id:digi_tab.$(t).closest(".wp-digi-sheet").data("id")};digi_tab.$.post(window.ajaxurl,n,function(i){digi_tab.$(".wp-digi-content").removeClass("wp-digi-bloc-loading"),digi_tab.$(".wp-digi-content").replaceWith(i.data.template),window.digi_global.init(digi_tab.$),window.digi_search.event(digi_tab.$);var t=e.replace("-","_");window[t]&&window[t].init&&window[t].init(!1,digi_tab.$)},"json")}}},digi_tools={$:void 0,event:function(i){digi_tools.$=i,digi_tools.$(document).on("click",".reset-method-evaluation",function(i){digi_tools.reset(i,digi_tools.$(this))}),digi_tools.$(document).on("click",".digi-tools-main-container .nav-tab",function(i){digi_tools.tab_switcher(i,digi_tools.$(this))}),digi_tools.$(document).on("click",".element-risk-compilation",function(i){digi_tools.risk_fixer(i,digi_tools.$(this))})},tab_switcher:function(i,t){i.preventDefault(),digi_tools.$(t).closest("h2").children(".nav-tab").each(function(){digi_tools.$(this).removeClass("nav-tab-active")}),digi_tools.$(t).addClass("nav-tab-active"),digi_tools.$(t).closest(".digi-tools-main-container").children("div").each(function(){digi_tools.$(this).hide()}),digi_tools.$("#"+digi_tools.$(t).attr("data-id")).show()},reset:function(i,t){if(i.preventDefault(),window.confirm(window.digi_tools_confirm)){digi_tools.$(t).addClass("wp-digi-loading"),digi_tools.$(t).closest("div").find("ul").html("");var e=document.createElement("li");e.innerHTML=window.digi_tools_in_progress,digi_tools.$(t).closest("div").find("ul").append(e);var n={action:"reset_method_evaluation",_wpnonce:digi_tools.$(t).data("nonce")};digi_tools.exec_request(e,n,t)}},risk_fixer:function(i,t){i.preventDefault(),digi_tools.$(t).addClass("wp-digi-loading"),digi_tools.$(t).closest("div").find("ul").html("");var e=document.createElement("li");e.innerHTML=window.digi_tools_in_progress,digi_tools.$(t).closest("div").find("ul").append(e);var n={action:"compil_risk_list",_wpnonce:digi_tools.$(t).data("nonce")};digi_tools.exec_request(e,n,t)},exec_request:function(i,t,e){digi_tools.$.post(window.ajaxurl,t,function(){digi_tools.$(e).removeClass("wp-digi-loading"),i.innerHTML+=" "+window.digi_tools_done})}};jQuery(document).ready(function(){jQuery("#wpdigi-datastransfer-form").ajaxForm({dataType:"json",beforeSubmit:function(i,t,e){t.children("button.wp-digi-bton").addClass("wp-digi-loading")},success:function(i,t,e,n){if(n.children("button.wp-digi-bton").removeClass("wp-digi-loading"),!i.status&&i.reload_transfert)"element"==i.sub_action?(jQuery(".wpdigi-transfered-element-nb-"+i.element_type).html(i.main_element_nb),i.main_element_nb==jQuery(".wpdigi-to-transfer-element-nb-"+i.element_type).html()&&jQuery(".wp-digi-datastransfer-element-type-name-"+i.element_type).addClass("dashicons-before dashicons-yes"),jQuery(".wpdigi-transfered-element-nb-"+i.sub_element_type).html(i.sub_element_nb),i.sub_element_nb==jQuery(".wpdigi-to-transfer-element-nb-"+i.sub_element_type).html()&&jQuery(".wp-digi-datastransfer-element-type-name-"+i.sub_element_type).addClass("dashicons-before dashicons-yes")):"config_components"==i.old_sub_action?jQuery(".wp-digi-transfert-components").html(i.display_components_transfer):(jQuery(".wpdigi-transfered-element-nb-documents").html(i.transfered),jQuery(".wpdigi-not-transfered-element-nb-documents").html(i.not_transfered),i.transfered+i.not_transfered==jQuery(".wpdigi-to-transfer-element-nb-wpdigi-to-transfer-element-nb-documents").html()&&jQuery("wp-digi-datastransfer-element-type-name-documents").addClass("dashicons-before dashicons-yes")),n.children("input[name=element_type_to_transfert]").val(i.element_type),n.children("input[name=sub_action]").val(i.sub_action),n.submit();else if(i.status){jQuery("#wp-digi-transfert-message").html(i.message).show(),jQuery("#wpdigi-datastransfer-form .wp-digi-bton-first").hide();var o={action:"reset_method_evaluation",_wpnonce:jQuery('input[name="_wpnonce"]').val()};jQuery.post(ajaxurl,o,function(){setTimeout(function(){window.location.href=i.redirect_to_url},"1500")})}}}),jQuery("input[name=wpdigi-dtrans-userid-behaviour]").click(function(){if(jQuery(this).is(":checked"))jQuery(".wp-digi-dtrans-userid-options-container").html("").hide();else{var i={action:"wpdigi-dtrans-transfert-options-load",element_type:jQuery(this).closest("form").children("input[name=element_type_to_transfert]").val()};jQuery(".wp-digi-dtrans-userid-options-container").load(ajaxurl,i).show()}})});var digi_user_import={$:void 0,init:function(i,t){digi_user_import.$=t,(i||void 0===i)&&digi_user_import.event()},event:function(){digi_user_import.$(document).on("submit","#digi-data-import-user #digi-export-form",function(i){digi_user_import.create_export(i,digi_user_import.$(this))}),digi_user_import.$(document).on("change",'#digi-data-import-user #digi-import-form input[type="file"]',function(i){digi_user_import.make_import(i,digi_user_import.$(this))})},create_export:function(i,t){i.preventDefault(),digi_user_import.$(t).closest("form").ajaxSubmit({beforeSubmit:function(){digi_user_import.$(t).closest(".wp-digi-bloc-loader").addClass("wp-digi-bloc-loading")},success:function(i){digi_user_import.$(t).closest(".wp-digi-bloc-loader").removeClass("wp-digi-bloc-loading"),window.digi_global.download_file(i.data.url_to_file,i.data.filename)}})},make_import:function(i,t){i.preventDefault();var e=new FormData;e.append("file",digi_user_import.$(t)[0].files[0]),e.append("action","digi_import_user"),e.append("_wpnonce",digi_user_import.$(t).closest("form").find('input[name="_wpnonce"]').val()),e.append("index_element",0),digi_user_import.request_import(e)},request_import:function(i){digi_user_import.$.ajax({url:ajaxurl,data:i,processData:!1,contentType:!1,type:"POST",beforeSend:function(){digi_user_import.$(".digi-import-detail").html(window.digi_tools_in_progress)},success:function(i){if(i.success){if(i.data.end)digi_user_import.$(".digi-import-detail").html(window.digi_tools_done);else{var t=new FormData;t.append("action","digi_import_user"),t.append("_wpnonce",digi_user_import.$("#digi-data-import-user #digi-import-form").find('input[name="_wpnonce"]').val()),t.append("index_element",i.data.index_element),t.append("count_element",i.data.count_element),t.append("path_to_csv",i.data.path_to_csv),digi_user_import.$(".digi-import-detail").html(window.digi_tools_in_progress),digi_user_import.request_import(t)}digi_user_import.$("progress").attr("max",i.data.count_element),digi_user_import.$("progress").val(i.data.index_element/i.data.count_element*i.data.count_element)}else alert("Problème lors de l'importation du modèle"),digi_installer.$("#digi-data-export").removeClass("wp-digi-bloc-loading")}})}};jQuery(document).ready(function(i){digi_user_import.init(!0,i)});var digi_user={old_affected_user:void 0,$:void 0,event:function(i){digi_user.$=i,digi_user.$(document).on("keyup",'.wp-list-search input[name="user_name_affected"]',function(){digi_user.search_affected_user(digi_user.$(this))}),digi_user.$(document).on("click",'.wp-form-user-to-assign input[type="submit"]',function(i){digi_user.add_user(i,digi_user.$(this))}),digi_user.$(document).on("click",".wp-digi-list-affected-user .wp-digi-action-delete",function(i){digi_user.delete_user(i,digi_user.$(this))}),digi_user.$(document).on("click",".wp-form-user-to-assign .wp-digi-pagination a",function(i){digi_user.pagination(i,digi_user.$(this))})},search_affected_user:function(i){if(digi_user.old_affected_user!=digi_user.$(i).val())if(digi_user.old_affected_user=digi_user.$(i).val(),digi_user.$(i).val().length>2){digi_user.$(i).val();digi_user.$(i).closest("form").ajaxSubmit(function(t){digi_user.$(i).closest("div").find(".wp-digi-list").replaceWith(t.data.template)})}else digi_user.$(i).val().length<=0&&digi_user.$(i).closest("form").ajaxSubmit(function(t){digi_user.$(i).closest("div").find(".wp-digi-list").replaceWith(t.data.template)})},add_user:function(i,t){i.preventDefault(),digi_user.$(".wp-digi-content").addClass("wp-digi-bloc-loading"),digi_user.$(t).closest("form").ajaxSubmit(function(i){digi_user.render(i)})},delete_user:function(i,t){if(i.preventDefault(),window.confirm(window.digi_confirm_delete)){digi_user.$(".wp-digi-content").addClass("wp-digi-bloc-loading");var e={action:"detach_user",id:digi_user.$(t).data("id"),user_id:digi_user.$(t).data("user-id"),affectation_id:digi_user.$(t).data("affectation-data-id")};digi_user.$.post(window.ajaxurl,e,function(i){digi_user.render(i)})}},render:function(i){digi_user.$(".wp-digi-content").removeClass("wp-digi-bloc-loading"),digi_user.$(".wp-digi-content").html(i.data.template)},pagination:function(i,t){i.preventDefault();var e=digi_user.$(t).attr("href").split("&"),n=e[1].replace("current_page=",""),o=e[2].replace("element_id=",""),a={action:"paginate_user",element_id:o,next_page:n};digi_user.$(".wp-form-user-to-assign").load(window.ajaxurl,a,function(){})}},digi_user_dashboard={$:void 0,event:function(i){digi_user_dashboard.$=i,digi_user_dashboard.email_event(),digi_user_dashboard.$(document).on("click","#wp-digi-form-add-staff .add-staff",function(i){digi_user_dashboard.edit_staff(i,digi_user_dashboard.$(this))}),digi_user_dashboard.$(document).on("click","#wp-digi-form-add-staff .wp-digi-action-load",function(i){digi_user_dashboard.load_staff(i,digi_user_dashboard.$(this))}),digi_user_dashboard.$(document).on("click","#wp-digi-form-add-staff .wp-digi-action-view-detail",function(i){digi_user_dashboard.load_staff_detail(i,digi_user_dashboard.$(this))}),digi_user_dashboard.$(document).on("click","#wp-digi-form-add-staff .wp-digi-action-edit",function(i){digi_user_dashboard.edit_staff(i,digi_user_dashboard.$(this))}),digi_user_dashboard.$(document).on("click","#wp-digi-form-add-staff .wp-digi-action-delete",function(i){digi_user_dashboard.delete_staff(i,digi_user_dashboard.$(this))})},email_event:function(){digi_user_dashboard.$(document).on("keyup",".user-dashboard .input-domain-mail",function(i){digi_user_dashboard.keyup_update_email(i,digi_user_dashboard.$(this))}),digi_user_dashboard.$(document).on("keyup",".wp-digi-table-item-new input.lastname",function(i){digi_user_dashboard.keyup_update_email(i,digi_user_dashboard.$(this))}),digi_user_dashboard.$(document).on("keyup",".wp-digi-table-item-new input.firstname",function(i){digi_user_dashboard.keyup_update_email(i,digi_user_dashboard.$(this))}),digi_user_dashboard.$(document).on("keyup",".wp-digi-table-item-new input.email",function(i){digi_user_dashboard.key_enter_send_form(i,digi_user_dashboard.$(this))}),digi_user_dashboard.$(document).on("click",".user-dashboard .wp-digi-action-save-domain-mail",function(i){digi_user_dashboard.save_domain_mail(i,digi_user_dashboard.$(this))})},keyup_update_email:function(i,t){var e=(digi_user_dashboard.$(".wp-digi-table-item-new .email").val(),digi_user_dashboard.$(".wp-digi-table-item-new .firstname").val()),n=digi_user_dashboard.$(".wp-digi-table-item-new .lastname").val(),o=digi_user_dashboard.$(".input-domain-mail").val(),a=window.digi_global.remove_diacritics(e+"."+n+"@"+o).toLowerCase();digi_user_dashboard.$(".wp-digi-table-item-new input.email").val(a),digi_user_dashboard.key_enter_send_form(i,t)},key_enter_send_form:function(i,t){13==i.keyCode&&digi_user_dashboard.$("#wp-digi-form-add-staff .add-staff").click()},save_domain_mail:function(i,t){i.preventDefault(),digi_user_dashboard.$(t).closest("li").addClass("wp-digi-bloc-loading");var e={action:"save_domain_mail",_wpnonce:digi_user_dashboard.$(t).data("nonce"),domain_mail:digi_user_dashboard.$(t).closest(".form-element").find("input").val()};digi_user_dashboard.$.post(window.ajaxurl,e,function(){digi_user_dashboard.$(t).closest("li").removeClass("wp-digi-bloc-loading")})},edit_staff:function(i,t){i.preventDefault(),digi_user_dashboard.$("#wp-digi-form-add-staff").ajaxSubmit({beforeSubmit:function(){digi_user_dashboard.$(".wp-digi-list-staff").addClass("wp-digi-bloc-loading")},success:function(i){digi_user_dashboard.$(".wp-digi-list-staff").removeClass("wp-digi-bloc-loading"),digi_user_dashboard.$(".wp-digi-list-staff").html(i.data.template),digi_user_dashboard.$(".wp-digi-list-staff .wp-digi-table-item-new .lastname").focus()}})},load_staff:function(i,t){i.preventDefault();var e=digi_user_dashboard.$(t).data("id");digi_user_dashboard.$('.wp-digi-list-item[data-id="'+e+'"]').addClass("wp-digi-bloc-loading");var n={action:"load_user",_wpnonce:digi_user_dashboard.$(t).data("nonce"),user_id:e};digi_user_dashboard.$.post(window.ajaxurl,n,function(i){digi_user_dashboard.$('.wp-digi-list-item[data-id="'+e+'"]').replaceWith(i.data.template)})},load_staff_detail:function(i,t){i.preventDefault();var e=digi_user_dashboard.$(t).data("id"),n=digi_user_dashboard.$(t).data("nonce"),o={action:"load_user_detail",_wpnonce:n,user_id:e};digi_user_dashboard.$(".user-detail").addClass("wp-digi-bloc-loading"),digi_user_dashboard.$.post(window.ajaxurl,o,function(i){digi_user_dashboard.$(".user-detail").replaceWith(i.data.template)})},delete_staff:function(i,t){if(i.preventDefault(),window.confirm(window.digi_confirm_delete)){var e=digi_user_dashboard.$(t).data("id");digi_user_dashboard.$('.wp-digi-list-staff .wp-digi-list-item[data-id="'+e+'"]').fadeOut();var n={action:"delete_user",_wpnonce:digi_user_dashboard.$(t).data("nonce"),user_id:e};digi_user_dashboard.$.post(window.ajaxurl,n,function(){})}}},digi_user_detail={$:void 0,event:function(i){digi_user_detail.$=i,digi_user_detail.$(document).on("click","#wp-digi-form-add-staff .wp-digi-action-view-detail",function(i){digi_user_detail.load_staff_detail(i,digi_user_detail.$(this))}),digi_user_detail.$(document).on("click",".user-detail .load-data",function(i){digi_user_detail.load_data(i,digi_user_detail.$(this))})},load_staff_detail:function(i,t){i.preventDefault();var e=digi_user_detail.$(t).data("id"),n=digi_user_detail.$(t).data("nonce"),o={action:"load_user_detail",_wpnonce:n,user_id:e};digi_user_detail.$(".user-detail").addClass("wp-digi-bloc-loading"),digi_user_detail.$.post(window.ajaxurl,o,function(i){digi_user_detail.$(".user-detail").replaceWith(i.data.template)})},load_data:function(i,t){var e=digi_user_detail.$(t).closest("ul").data("user-id"),n=digi_user_detail.$(t).closest("ul").data("nonce"),o=digi_user_detail.$(t).data("name"),a={action:"load_data",_wpnonce:n,user_id:e,data_name:o};digi_user_detail.$(".user-detail .wp-digi-list").addClass("wp-digi-bloc-loading"),digi_user_detail.$.post(window.ajaxurl,a,function(i){digi_user_detail.$(".user-detail .wp-digi-list").replaceWith(i.data.template)})}},digi_workunit={$:void 0,event:function(i){digi_workunit.$=i,digi_workunit.$(".wp-digi-societytree-main-container").on("keypress","input[name='workunit[title]']",function(i){digi_workunit.call_create_workunit(i)}),digi_workunit.$(".wp-digi-societytree-main-container").on("click",".wp-digi-new-workunit-action",function(i){digi_workunit.create_workunit(i,digi_workunit.$(this))}),digi_workunit.$(document).on("click",".wp-digi-list-workunit .wp-digi-action-delete",function(i){digi_workunit.delete_workunit(i,digi_workunit.$(this))}),digi_workunit.$(document).on("click",".wp-digi-sheet-tab-toggle",function(){window.digi_global.responsive_menu_toggle(digi_workunit.$(this))}),digi_workunit.$(document).on("click",".wp-digi-sheet-tab-responsive-content > li",function(){window.digi_global.responsive_menu_toggle(digi_workunit.$(this))})},call_create_workunit:function(i){13==i.keyCode&&(i.preventDefault(),digi_workunit.$(".wp-digi-societytree-main-container .wp-digi-new-workunit-action").click())},create_workunit:function(i,t){i.preventDefault(),digi_workunit.$("#wpdigi-workunit-creation-form").ajaxSubmit({dataType:"json",beforeSubmit:function(i,t,e){digi_workunit.$(".wp-digi-societytree-left-container").addClass("wp-digi-bloc-loading")},success:function(i,t,e,n){digi_workunit.$(".wp-digi-societytree-left-container").removeClass("wp-digi-bloc-loading"),digi_workunit.$(".wp-digi-list-workunit").replaceWith(i.data.template),digi_workunit.$(".wp-digi-workunit-"+i.data.id+" .wp-digi-global-name").click(),window.digi_search.event(digi_workunit.$)}})},delete_workunit:function(i,t){if(i.preventDefault(),window.confirm(window.digi_confirm_delete)){var e={action:"delete_society",element_id:digi_workunit.$(t).data("id")};digi_workunit.$(t).closest("li").fadeOut(),digi_workunit.$.post(window.ajaxurl,e,function(i){})}}};(function(){"use strict";var i=this,t=i.Chart,e=function(i){this.canvas=i.canvas,this.ctx=i;var t=function(i,t){return i["offset"+t]?i["offset"+t]:document.defaultView.getComputedStyle(i).getPropertyValue(t)},e=this.width=t(i.canvas,"Width")||i.canvas.width,o=this.height=t(i.canvas,"Height")||i.canvas.height;return e=this.width=i.canvas.width,o=this.height=i.canvas.height,this.aspectRatio=this.width/this.height,n.retinaScale(this),this};e.defaults={global:{animation:!0,animationSteps:60,animationEasing:"easeOutQuart",showScale:!0,scaleOverride:!1,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:!0,scaleLabel:"<%=value%>",scaleIntegersOnly:!0,scaleBeginAtZero:!1,scaleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",responsive:!1,maintainAspectRatio:!0,showTooltips:!0,customTooltips:!1,tooltipEvents:["mousemove","touchstart","touchmove","mouseout"],tooltipFillColor:"rgba(0,0,0,0.8)",tooltipFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipFontSize:14,tooltipFontStyle:"normal",tooltipFontColor:"#fff",tooltipTitleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipTitleFontSize:14,tooltipTitleFontStyle:"bold",tooltipTitleFontColor:"#fff",tooltipTitleTemplate:"<%= label%>",tooltipYPadding:6,tooltipXPadding:6,tooltipCaretSize:8,tooltipCornerRadius:6,tooltipXOffset:10,tooltipTemplate:"<%if (label){%><%=label%>: <%}%><%= value %>",multiTooltipTemplate:"<%= value %>",multiTooltipKeyBackground:"#fff",segmentColorDefault:["#A6CEE3","#1F78B4","#B2DF8A","#33A02C","#FB9A99","#E31A1C","#FDBF6F","#FF7F00","#CAB2D6","#6A3D9A","#B4B482","#B15928"],segmentHighlightColorDefaults:["#CEF6FF","#47A0DC","#DAFFB2","#5BC854","#FFC2C1","#FF4244","#FFE797","#FFA728","#F2DAFE","#9265C2","#DCDCAA","#D98150"],onAnimationProgress:function(){},onAnimationComplete:function(){}}},e.types={};var n=e.helpers={},o=n.each=function(i,t,e){var n=Array.prototype.slice.call(arguments,3);if(i)if(i.length===+i.length){var o;for(o=0;o<i.length;o++)t.apply(e,[i[o],o].concat(n));
}else for(var a in i)t.apply(e,[i[a],a].concat(n))},a=n.clone=function(i){var t={};return o(i,function(e,n){i.hasOwnProperty(n)&&(t[n]=e)}),t},s=n.extend=function(i){return o(Array.prototype.slice.call(arguments,1),function(t){o(t,function(e,n){t.hasOwnProperty(n)&&(i[n]=e)})}),i},d=n.merge=function(i,t){var e=Array.prototype.slice.call(arguments,0);return e.unshift({}),s.apply(null,e)},l=n.indexOf=function(i,t){if(Array.prototype.indexOf)return i.indexOf(t);for(var e=0;e<i.length;e++)if(i[e]===t)return e;return-1},r=(n.where=function(i,t){var e=[];return n.each(i,function(i){t(i)&&e.push(i)}),e},n.findNextWhere=function(i,t,e){e||(e=-1);for(var n=e+1;n<i.length;n++){var o=i[n];if(t(o))return o}},n.findPreviousWhere=function(i,t,e){e||(e=i.length);for(var n=e-1;n>=0;n--){var o=i[n];if(t(o))return o}},n.inherits=function(i){var t=this,e=i&&i.hasOwnProperty("constructor")?i.constructor:function(){return t.apply(this,arguments)},n=function(){this.constructor=e};return n.prototype=t.prototype,e.prototype=new n,e.extend=r,i&&s(e.prototype,i),e.__super__=t.prototype,e}),c=n.noop=function(){},h=n.uid=function(){var i=0;return function(){return"chart-"+i++}}(),g=n.warn=function(i){window.console&&"function"==typeof window.console.warn&&console.warn(i)},u=n.amd="function"==typeof define&&define.amd,p=n.isNumber=function(i){return!isNaN(parseFloat(i))&&isFinite(i)},m=n.max=function(i){return Math.max.apply(Math,i)},_=n.min=function(i){return Math.min.apply(Math,i)},f=(n.cap=function(i,t,e){if(p(t)){if(i>t)return t}else if(p(e)&&e>i)return e;return i},n.getDecimalPlaces=function(i){if(i%1!==0&&p(i)){var t=i.toString();if(t.indexOf("e-")<0)return t.split(".")[1].length;if(t.indexOf(".")<0)return parseInt(t.split("e-")[1]);var e=t.split(".")[1].split("e-");return e[0].length+parseInt(e[1])}return 0}),w=n.radians=function(i){return i*(Math.PI/180)},v=(n.getAngleFromPoint=function(i,t){var e=t.x-i.x,n=t.y-i.y,o=Math.sqrt(e*e+n*n),a=2*Math.PI+Math.atan2(n,e);return 0>e&&0>n&&(a+=2*Math.PI),{angle:a,distance:o}},n.aliasPixel=function(i){return i%2===0?0:.5}),b=(n.splineCurve=function(i,t,e,n){var o=Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)),a=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),s=n*o/(o+a),d=n*a/(o+a);return{inner:{x:t.x-s*(e.x-i.x),y:t.y-s*(e.y-i.y)},outer:{x:t.x+d*(e.x-i.x),y:t.y+d*(e.y-i.y)}}},n.calculateOrderOfMagnitude=function(i){return Math.floor(Math.log(i)/Math.LN10)}),$=(n.calculateScaleRange=function(i,t,e,n,a){var s=2,d=Math.floor(t/(1.5*e)),l=s>=d,r=[];o(i,function(i){null==i||r.push(i)});var c=_(r),h=m(r);h===c&&(h+=.5,c>=.5&&!n?c-=.5:h+=.5);for(var g=Math.abs(h-c),u=b(g),p=Math.ceil(h/(1*Math.pow(10,u)))*Math.pow(10,u),f=n?0:Math.floor(c/(1*Math.pow(10,u)))*Math.pow(10,u),w=p-f,v=Math.pow(10,u),$=Math.round(w/v);($>d||d>2*$)&&!l;)if($>d)v*=2,$=Math.round(w/v),$%1!==0&&(l=!0);else if(a&&u>=0){if(v/2%1!==0)break;v/=2,$=Math.round(w/v)}else v/=2,$=Math.round(w/v);return l&&($=s,v=w/$),{steps:$,stepValue:v,min:f,max:f+$*v}},n.template=function(i,t){function e(i,t){var e=/\W/.test(i)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+i.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):n[i]=n[i];return t?e(t):e}if(i instanceof Function)return i(t);var n={};return e(i,t)}),y=(n.generateLabels=function(i,t,e,n){var a=new Array(t);return i&&o(a,function(t,o){a[o]=$(i,{value:e+n*(o+1)})}),a},n.easingEffects={linear:function(i){return i},easeInQuad:function(i){return i*i},easeOutQuad:function(i){return-1*i*(i-2)},easeInOutQuad:function(i){return(i/=.5)<1?.5*i*i:-.5*(--i*(i-2)-1)},easeInCubic:function(i){return i*i*i},easeOutCubic:function(i){return 1*((i=i/1-1)*i*i+1)},easeInOutCubic:function(i){return(i/=.5)<1?.5*i*i*i:.5*((i-=2)*i*i+2)},easeInQuart:function(i){return i*i*i*i},easeOutQuart:function(i){return-1*((i=i/1-1)*i*i*i-1)},easeInOutQuart:function(i){return(i/=.5)<1?.5*i*i*i*i:-.5*((i-=2)*i*i*i-2)},easeInQuint:function(i){return 1*(i/=1)*i*i*i*i},easeOutQuint:function(i){return 1*((i=i/1-1)*i*i*i*i+1)},easeInOutQuint:function(i){return(i/=.5)<1?.5*i*i*i*i*i:.5*((i-=2)*i*i*i*i+2)},easeInSine:function(i){return-1*Math.cos(i/1*(Math.PI/2))+1},easeOutSine:function(i){return 1*Math.sin(i/1*(Math.PI/2))},easeInOutSine:function(i){return-.5*(Math.cos(Math.PI*i/1)-1)},easeInExpo:function(i){return 0===i?1:1*Math.pow(2,10*(i/1-1))},easeOutExpo:function(i){return 1===i?1:1*(-Math.pow(2,-10*i/1)+1)},easeInOutExpo:function(i){return 0===i?0:1===i?1:(i/=.5)<1?.5*Math.pow(2,10*(i-1)):.5*(-Math.pow(2,-10*--i)+2)},easeInCirc:function(i){return i>=1?i:-1*(Math.sqrt(1-(i/=1)*i)-1)},easeOutCirc:function(i){return 1*Math.sqrt(1-(i=i/1-1)*i)},easeInOutCirc:function(i){return(i/=.5)<1?-.5*(Math.sqrt(1-i*i)-1):.5*(Math.sqrt(1-(i-=2)*i)+1)},easeInElastic:function(i){var t=1.70158,e=0,n=1;return 0===i?0:1==(i/=1)?1:(e||(e=.3),n<Math.abs(1)?(n=1,t=e/4):t=e/(2*Math.PI)*Math.asin(1/n),-(n*Math.pow(2,10*(i-=1))*Math.sin((1*i-t)*(2*Math.PI)/e)))},easeOutElastic:function(i){var t=1.70158,e=0,n=1;return 0===i?0:1==(i/=1)?1:(e||(e=.3),n<Math.abs(1)?(n=1,t=e/4):t=e/(2*Math.PI)*Math.asin(1/n),n*Math.pow(2,-10*i)*Math.sin((1*i-t)*(2*Math.PI)/e)+1)},easeInOutElastic:function(i){var t=1.70158,e=0,n=1;return 0===i?0:2==(i/=.5)?1:(e||(e=1*(.3*1.5)),n<Math.abs(1)?(n=1,t=e/4):t=e/(2*Math.PI)*Math.asin(1/n),1>i?-.5*(n*Math.pow(2,10*(i-=1))*Math.sin((1*i-t)*(2*Math.PI)/e)):n*Math.pow(2,-10*(i-=1))*Math.sin((1*i-t)*(2*Math.PI)/e)*.5+1)},easeInBack:function(i){var t=1.70158;return 1*(i/=1)*i*((t+1)*i-t)},easeOutBack:function(i){var t=1.70158;return 1*((i=i/1-1)*i*((t+1)*i+t)+1)},easeInOutBack:function(i){var t=1.70158;return(i/=.5)<1?.5*(i*i*(((t*=1.525)+1)*i-t)):.5*((i-=2)*i*(((t*=1.525)+1)*i+t)+2)},easeInBounce:function(i){return 1-y.easeOutBounce(1-i)},easeOutBounce:function(i){return(i/=1)<1/2.75?1*(7.5625*i*i):2/2.75>i?1*(7.5625*(i-=1.5/2.75)*i+.75):2.5/2.75>i?1*(7.5625*(i-=2.25/2.75)*i+.9375):1*(7.5625*(i-=2.625/2.75)*i+.984375)},easeInOutBounce:function(i){return.5>i?.5*y.easeInBounce(2*i):.5*y.easeOutBounce(2*i-1)+.5}}),k=n.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(i){return window.setTimeout(i,1e3/60)}}(),x=(n.cancelAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(i){return window.clearTimeout(i,1e3/60)}}(),n.animationLoop=function(i,t,e,n,o,a){var s=0,d=y[e]||y.linear,l=function(){s++;var e=s/t,r=d(e);i.call(a,r,e,s),n.call(a,r,e),t>s?a.animationFrame=k(l):o.apply(a)};k(l)},n.getRelativePosition=function(i){var t,e,n=i.originalEvent||i,o=i.currentTarget||i.srcElement,a=o.getBoundingClientRect();return n.touches?(t=n.touches[0].clientX-a.left,e=n.touches[0].clientY-a.top):(t=n.clientX-a.left,e=n.clientY-a.top),{x:t,y:e}},n.addEvent=function(i,t,e){i.addEventListener?i.addEventListener(t,e):i.attachEvent?i.attachEvent("on"+t,e):i["on"+t]=e}),C=n.removeEvent=function(i,t,e){i.removeEventListener?i.removeEventListener(t,e,!1):i.detachEvent?i.detachEvent("on"+t,e):i["on"+t]=c},S=(n.bindEvents=function(i,t,e){i.events||(i.events={}),o(t,function(t){i.events[t]=function(){e.apply(i,arguments)},x(i.chart.canvas,t,i.events[t])})},n.unbindEvents=function(i,t){o(t,function(t,e){C(i.chart.canvas,e,t)})}),P=n.getMaximumWidth=function(i){var t=i.parentNode,e=parseInt(F(t,"padding-left"))+parseInt(F(t,"padding-right"));return t.clientWidth-e},L=n.getMaximumHeight=function(i){var t=i.parentNode,e=parseInt(F(t,"padding-bottom"))+parseInt(F(t,"padding-top"));return t.clientHeight-e},F=n.getStyle=function(i,t){return i.currentStyle?i.currentStyle[t]:document.defaultView.getComputedStyle(i,null).getPropertyValue(t)},A=(n.getMaximumSize=n.getMaximumWidth,n.retinaScale=function(i){var t=i.ctx,e=i.canvas.width,n=i.canvas.height;window.devicePixelRatio&&(t.canvas.style.width=e+"px",t.canvas.style.height=n+"px",t.canvas.height=n*window.devicePixelRatio,t.canvas.width=e*window.devicePixelRatio,t.scale(window.devicePixelRatio,window.devicePixelRatio))}),T=n.clear=function(i){i.ctx.clearRect(0,0,i.width,i.height)},W=n.fontString=function(i,t,e){return t+" "+i+"px "+e},R=n.longestText=function(i,t,e){i.font=t;var n=0;return o(e,function(t){var e=i.measureText(t).width;n=e>n?e:n}),n},j=n.drawRoundedRectangle=function(i,t,e,n,o,a){i.beginPath(),i.moveTo(t+a,e),i.lineTo(t+n-a,e),i.quadraticCurveTo(t+n,e,t+n,e+a),i.lineTo(t+n,e+o-a),i.quadraticCurveTo(t+n,e+o,t+n-a,e+o),i.lineTo(t+a,e+o),i.quadraticCurveTo(t,e+o,t,e+o-a),i.lineTo(t,e+a),i.quadraticCurveTo(t,e,t+a,e),i.closePath()};e.instances={},e.Type=function(i,t,n){this.options=t,this.chart=n,this.id=h(),e.instances[this.id]=this,t.responsive&&this.resize(),this.initialize.call(this,i)},s(e.Type.prototype,{initialize:function(){return this},clear:function(){return T(this.chart),this},stop:function(){return e.animationService.cancelAnimation(this),this},resize:function(i){this.stop();var t=this.chart.canvas,e=P(this.chart.canvas),n=this.options.maintainAspectRatio?e/this.chart.aspectRatio:L(this.chart.canvas);return t.width=this.chart.width=e,t.height=this.chart.height=n,A(this.chart),"function"==typeof i&&i.apply(this,Array.prototype.slice.call(arguments,1)),this},reflow:c,render:function(i){if(i&&this.reflow(),this.options.animation&&!i){var t=new e.Animation;t.numSteps=this.options.animationSteps,t.easing=this.options.animationEasing,t.render=function(i,t){var e=n.easingEffects[t.easing],o=t.currentStep/t.numSteps,a=e(o);i.draw(a,o,t.currentStep)},t.onAnimationProgress=this.options.onAnimationProgress,t.onAnimationComplete=this.options.onAnimationComplete,e.animationService.addAnimation(this,t)}else this.draw(),this.options.onAnimationComplete.call(this);return this},generateLegend:function(){return $(this.options.legendTemplate,this)},destroy:function(){this.clear(),S(this,this.events);var i=this.chart.canvas;i.width=this.chart.width,i.height=this.chart.height,i.style.removeProperty?(i.style.removeProperty("width"),i.style.removeProperty("height")):(i.style.removeAttribute("width"),i.style.removeAttribute("height")),delete e.instances[this.id]},showTooltip:function(i,t){"undefined"==typeof this.activeElements&&(this.activeElements=[]);var a=function(i){var t=!1;return i.length!==this.activeElements.length?t=!0:(o(i,function(i,e){i!==this.activeElements[e]&&(t=!0)},this),t)}.call(this,i);if(a||t){if(this.activeElements=i,this.draw(),this.options.customTooltips&&this.options.customTooltips(!1),i.length>0)if(this.datasets&&this.datasets.length>1){for(var s,d,r=this.datasets.length-1;r>=0&&(s=this.datasets[r].points||this.datasets[r].bars||this.datasets[r].segments,d=l(s,i[0]),-1===d);r--);var c=[],h=[],g=function(i){var t,e,o,a,s,l=[],r=[],g=[];return n.each(this.datasets,function(i){t=i.points||i.bars||i.segments,t[d]&&t[d].hasValue()&&l.push(t[d])}),n.each(l,function(i){r.push(i.x),g.push(i.y),c.push(n.template(this.options.multiTooltipTemplate,i)),h.push({fill:i._saved.fillColor||i.fillColor,stroke:i._saved.strokeColor||i.strokeColor})},this),s=_(g),o=m(g),a=_(r),e=m(r),{x:a>this.chart.width/2?a:e,y:(s+o)/2}}.call(this,d);new e.MultiTooltip({x:g.x,y:g.y,xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,xOffset:this.options.tooltipXOffset,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,titleTextColor:this.options.tooltipTitleFontColor,titleFontFamily:this.options.tooltipTitleFontFamily,titleFontStyle:this.options.tooltipTitleFontStyle,titleFontSize:this.options.tooltipTitleFontSize,cornerRadius:this.options.tooltipCornerRadius,labels:c,legendColors:h,legendColorBackground:this.options.multiTooltipKeyBackground,title:$(this.options.tooltipTitleTemplate,i[0]),chart:this.chart,ctx:this.chart.ctx,custom:this.options.customTooltips}).draw()}else o(i,function(i){var t=i.tooltipPosition();new e.Tooltip({x:Math.round(t.x),y:Math.round(t.y),xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,caretHeight:this.options.tooltipCaretSize,cornerRadius:this.options.tooltipCornerRadius,text:$(this.options.tooltipTemplate,i),chart:this.chart,custom:this.options.customTooltips}).draw()},this);return this}},toBase64Image:function(){return this.chart.canvas.toDataURL.apply(this.chart.canvas,arguments)}}),e.Type.extend=function(i){var t=this,n=function(){return t.apply(this,arguments)};if(n.prototype=a(t.prototype),s(n.prototype,i),n.extend=e.Type.extend,i.name||t.prototype.name){var o=i.name||t.prototype.name,l=e.defaults[t.prototype.name]?a(e.defaults[t.prototype.name]):{};e.defaults[o]=s(l,i.defaults),e.types[o]=n,e.prototype[o]=function(i,t){var a=d(e.defaults.global,e.defaults[o],t||{});return new n(i,a,this)}}else g("Name not provided for this chart, so it hasn't been registered");return t},e.Element=function(i){s(this,i),this.initialize.apply(this,arguments),this.save()},s(e.Element.prototype,{initialize:function(){},restore:function(i){return i?o(i,function(i){this[i]=this._saved[i]},this):s(this,this._saved),this},save:function(){return this._saved=a(this),delete this._saved._saved,this},update:function(i){return o(i,function(i,t){this._saved[t]=this[t],this[t]=i},this),this},transition:function(i,t){return o(i,function(i,e){this[e]=(i-this._saved[e])*t+this._saved[e]},this),this},tooltipPosition:function(){return{x:this.x,y:this.y}},hasValue:function(){return p(this.value)}}),e.Element.extend=r,e.Point=e.Element.extend({display:!0,inRange:function(i,t){var e=this.hitDetectionRadius+this.radius;return Math.pow(i-this.x,2)+Math.pow(t-this.y,2)<Math.pow(e,2)},draw:function(){if(this.display){var i=this.ctx;i.beginPath(),i.arc(this.x,this.y,this.radius,0,2*Math.PI),i.closePath(),i.strokeStyle=this.strokeColor,i.lineWidth=this.strokeWidth,i.fillStyle=this.fillColor,i.fill(),i.stroke()}}}),e.Arc=e.Element.extend({inRange:function(i,t){var e=n.getAngleFromPoint(this,{x:i,y:t}),o=e.angle%(2*Math.PI),a=(2*Math.PI+this.startAngle)%(2*Math.PI),s=(2*Math.PI+this.endAngle)%(2*Math.PI)||360,d=a>s?s>=o||o>=a:o>=a&&s>=o,l=e.distance>=this.innerRadius&&e.distance<=this.outerRadius;return d&&l},tooltipPosition:function(){var i=this.startAngle+(this.endAngle-this.startAngle)/2,t=(this.outerRadius-this.innerRadius)/2+this.innerRadius;return{x:this.x+Math.cos(i)*t,y:this.y+Math.sin(i)*t}},draw:function(i){var t=this.ctx;t.beginPath(),t.arc(this.x,this.y,this.outerRadius<0?0:this.outerRadius,this.startAngle,this.endAngle),t.arc(this.x,this.y,this.innerRadius<0?0:this.innerRadius,this.endAngle,this.startAngle,!0),t.closePath(),t.strokeStyle=this.strokeColor,t.lineWidth=this.strokeWidth,t.fillStyle=this.fillColor,t.fill(),t.lineJoin="bevel",this.showStroke&&t.stroke()}}),e.Rectangle=e.Element.extend({draw:function(){var i=this.ctx,t=this.width/2,e=this.x-t,n=this.x+t,o=this.base-(this.base-this.y),a=this.strokeWidth/2;this.showStroke&&(e+=a,n-=a,o+=a),i.beginPath(),i.fillStyle=this.fillColor,i.strokeStyle=this.strokeColor,i.lineWidth=this.strokeWidth,i.moveTo(e,this.base),i.lineTo(e,o),i.lineTo(n,o),i.lineTo(n,this.base),i.fill(),this.showStroke&&i.stroke()},height:function(){return this.base-this.y},inRange:function(i,t){return i>=this.x-this.width/2&&i<=this.x+this.width/2&&t>=this.y&&t<=this.base}}),e.Animation=e.Element.extend({currentStep:null,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null}),e.Tooltip=e.Element.extend({draw:function(){var i=this.chart.ctx;i.font=W(this.fontSize,this.fontStyle,this.fontFamily),this.xAlign="center",this.yAlign="above";var t=this.caretPadding=2,e=i.measureText(this.text).width+2*this.xPadding,n=this.fontSize+2*this.yPadding,o=n+this.caretHeight+t;this.x+e/2>this.chart.width?this.xAlign="left":this.x-e/2<0&&(this.xAlign="right"),this.y-o<0&&(this.yAlign="below");var a=this.x-e/2,s=this.y-o;if(i.fillStyle=this.fillColor,this.custom)this.custom(this);else{switch(this.yAlign){case"above":i.beginPath(),i.moveTo(this.x,this.y-t),i.lineTo(this.x+this.caretHeight,this.y-(t+this.caretHeight)),i.lineTo(this.x-this.caretHeight,this.y-(t+this.caretHeight)),i.closePath(),i.fill();break;case"below":s=this.y+t+this.caretHeight,i.beginPath(),i.moveTo(this.x,this.y+t),i.lineTo(this.x+this.caretHeight,this.y+t+this.caretHeight),i.lineTo(this.x-this.caretHeight,this.y+t+this.caretHeight),i.closePath(),i.fill()}switch(this.xAlign){case"left":a=this.x-e+(this.cornerRadius+this.caretHeight);break;case"right":a=this.x-(this.cornerRadius+this.caretHeight)}j(i,a,s,e,n,this.cornerRadius),i.fill(),i.fillStyle=this.textColor,i.textAlign="center",i.textBaseline="middle",i.fillText(this.text,a+e/2,s+n/2)}}}),e.MultiTooltip=e.Element.extend({initialize:function(){this.font=W(this.fontSize,this.fontStyle,this.fontFamily),this.titleFont=W(this.titleFontSize,this.titleFontStyle,this.titleFontFamily),this.titleHeight=this.title?1.5*this.titleFontSize:0,this.height=this.labels.length*this.fontSize+(this.labels.length-1)*(this.fontSize/2)+2*this.yPadding+this.titleHeight,this.ctx.font=this.titleFont;var i=this.ctx.measureText(this.title).width,t=R(this.ctx,this.font,this.labels)+this.fontSize+3,e=m([t,i]);this.width=e+2*this.xPadding;var n=this.height/2;this.y-n<0?this.y=n:this.y+n>this.chart.height&&(this.y=this.chart.height-n),this.x>this.chart.width/2?this.x-=this.xOffset+this.width:this.x+=this.xOffset},getLineHeight:function(i){var t=this.y-this.height/2+this.yPadding,e=i-1;return 0===i?t+this.titleHeight/3:t+(1.5*this.fontSize*e+this.fontSize/2)+this.titleHeight},draw:function(){if(this.custom)this.custom(this);else{j(this.ctx,this.x,this.y-this.height/2,this.width,this.height,this.cornerRadius);var i=this.ctx;i.fillStyle=this.fillColor,i.fill(),i.closePath(),i.textAlign="left",i.textBaseline="middle",i.fillStyle=this.titleTextColor,i.font=this.titleFont,i.fillText(this.title,this.x+this.xPadding,this.getLineHeight(0)),i.font=this.font,n.each(this.labels,function(t,e){i.fillStyle=this.textColor,i.fillText(t,this.x+this.xPadding+this.fontSize+3,this.getLineHeight(e+1)),i.fillStyle=this.legendColorBackground,i.fillRect(this.x+this.xPadding,this.getLineHeight(e+1)-this.fontSize/2,this.fontSize,this.fontSize),i.fillStyle=this.legendColors[e].fill,i.fillRect(this.x+this.xPadding,this.getLineHeight(e+1)-this.fontSize/2,this.fontSize,this.fontSize)},this)}}}),e.Scale=e.Element.extend({initialize:function(){this.fit()},buildYLabels:function(){this.yLabels=[];for(var i=f(this.stepValue),t=0;t<=this.steps;t++)this.yLabels.push($(this.templateString,{value:(this.min+t*this.stepValue).toFixed(i)}));this.yLabelWidth=this.display&&this.showLabels?R(this.ctx,this.font,this.yLabels)+10:0},addXLabel:function(i){this.xLabels.push(i),this.valuesCount++,this.fit()},removeXLabel:function(){this.xLabels.shift(),this.valuesCount--,this.fit()},fit:function(){this.startPoint=this.display?this.fontSize:0,this.endPoint=this.display?this.height-1.5*this.fontSize-5:this.height,this.startPoint+=this.padding,this.endPoint-=this.padding;var i,t=this.endPoint,e=this.endPoint-this.startPoint;for(this.calculateYRange(e),this.buildYLabels(),this.calculateXLabelRotation();e>this.endPoint-this.startPoint;)e=this.endPoint-this.startPoint,i=this.yLabelWidth,this.calculateYRange(e),this.buildYLabels(),i<this.yLabelWidth&&(this.endPoint=t,this.calculateXLabelRotation())},calculateXLabelRotation:function(){this.ctx.font=this.font;var i,t,e=this.ctx.measureText(this.xLabels[0]).width,n=this.ctx.measureText(this.xLabels[this.xLabels.length-1]).width;if(this.xScalePaddingRight=n/2+3,this.xScalePaddingLeft=e/2>this.yLabelWidth?e/2:this.yLabelWidth,this.xLabelRotation=0,this.display){var o,a=R(this.ctx,this.font,this.xLabels);this.xLabelWidth=a;for(var s=Math.floor(this.calculateX(1)-this.calculateX(0))-6;this.xLabelWidth>s&&0===this.xLabelRotation||this.xLabelWidth>s&&this.xLabelRotation<=90&&this.xLabelRotation>0;)o=Math.cos(w(this.xLabelRotation)),i=o*e,t=o*n,i+this.fontSize/2>this.yLabelWidth&&(this.xScalePaddingLeft=i+this.fontSize/2),this.xScalePaddingRight=this.fontSize/2,this.xLabelRotation++,this.xLabelWidth=o*a;this.xLabelRotation>0&&(this.endPoint-=Math.sin(w(this.xLabelRotation))*a+3)}else this.xLabelWidth=0,this.xScalePaddingRight=this.padding,this.xScalePaddingLeft=this.padding},calculateYRange:c,drawingArea:function(){return this.startPoint-this.endPoint},calculateY:function(i){var t=this.drawingArea()/(this.min-this.max);return this.endPoint-t*(i-this.min)},calculateX:function(i){var t=(this.xLabelRotation>0,this.width-(this.xScalePaddingLeft+this.xScalePaddingRight)),e=t/Math.max(this.valuesCount-(this.offsetGridLines?0:1),1),n=e*i+this.xScalePaddingLeft;return this.offsetGridLines&&(n+=e/2),Math.round(n)},update:function(i){n.extend(this,i),this.fit()},draw:function(){var i=this.ctx,t=(this.endPoint-this.startPoint)/this.steps,e=Math.round(this.xScalePaddingLeft);this.display&&(i.fillStyle=this.textColor,i.font=this.font,o(this.yLabels,function(o,a){var s=this.endPoint-t*a,d=Math.round(s),l=this.showHorizontalLines;i.textAlign="right",i.textBaseline="middle",this.showLabels&&i.fillText(o,e-10,s),0!==a||l||(l=!0),l&&i.beginPath(),a>0?(i.lineWidth=this.gridLineWidth,i.strokeStyle=this.gridLineColor):(i.lineWidth=this.lineWidth,i.strokeStyle=this.lineColor),d+=n.aliasPixel(i.lineWidth),l&&(i.moveTo(e,d),i.lineTo(this.width,d),i.stroke(),i.closePath()),i.lineWidth=this.lineWidth,i.strokeStyle=this.lineColor,i.beginPath(),i.moveTo(e-5,d),i.lineTo(e,d),i.stroke(),i.closePath()},this),o(this.xLabels,function(t,e){var n=this.calculateX(e)+v(this.lineWidth),o=this.calculateX(e-(this.offsetGridLines?.5:0))+v(this.lineWidth),a=this.xLabelRotation>0,s=this.showVerticalLines;0!==e||s||(s=!0),s&&i.beginPath(),e>0?(i.lineWidth=this.gridLineWidth,i.strokeStyle=this.gridLineColor):(i.lineWidth=this.lineWidth,i.strokeStyle=this.lineColor),s&&(i.moveTo(o,this.endPoint),i.lineTo(o,this.startPoint-3),i.stroke(),i.closePath()),i.lineWidth=this.lineWidth,i.strokeStyle=this.lineColor,i.beginPath(),i.moveTo(o,this.endPoint),i.lineTo(o,this.endPoint+5),i.stroke(),i.closePath(),i.save(),i.translate(n,a?this.endPoint+12:this.endPoint+8),i.rotate(-1*w(this.xLabelRotation)),i.font=this.font,i.textAlign=a?"right":"center",i.textBaseline=a?"middle":"top",i.fillText(t,0,0),i.restore()},this))}}),e.RadialScale=e.Element.extend({initialize:function(){this.size=_([this.height,this.width]),this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2},calculateCenterOffset:function(i){var t=this.drawingArea/(this.max-this.min);return(i-this.min)*t},update:function(){this.lineArc?this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2:this.setScaleSize(),this.buildYLabels()},buildYLabels:function(){this.yLabels=[];for(var i=f(this.stepValue),t=0;t<=this.steps;t++)this.yLabels.push($(this.templateString,{value:(this.min+t*this.stepValue).toFixed(i)}))},getCircumference:function(){return 2*Math.PI/this.valuesCount},setScaleSize:function(){var i,t,e,n,o,a,s,d,l,r,c,h,g=_([this.height/2-this.pointLabelFontSize-5,this.width/2]),u=this.width,m=0;for(this.ctx.font=W(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily),t=0;t<this.valuesCount;t++)i=this.getPointPosition(t,g),e=this.ctx.measureText($(this.templateString,{value:this.labels[t]})).width+5,0===t||t===this.valuesCount/2?(n=e/2,i.x+n>u&&(u=i.x+n,o=t),i.x-n<m&&(m=i.x-n,s=t)):t<this.valuesCount/2?i.x+e>u&&(u=i.x+e,o=t):t>this.valuesCount/2&&i.x-e<m&&(m=i.x-e,s=t);l=m,r=Math.ceil(u-this.width),a=this.getIndexAngle(o),d=this.getIndexAngle(s),c=r/Math.sin(a+Math.PI/2),h=l/Math.sin(d+Math.PI/2),c=p(c)?c:0,h=p(h)?h:0,this.drawingArea=g-(h+c)/2,this.setCenterPoint(h,c)},setCenterPoint:function(i,t){var e=this.width-t-this.drawingArea,n=i+this.drawingArea;this.xCenter=(n+e)/2,this.yCenter=this.height/2},getIndexAngle:function(i){var t=2*Math.PI/this.valuesCount;return i*t-Math.PI/2},getPointPosition:function(i,t){var e=this.getIndexAngle(i);return{x:Math.cos(e)*t+this.xCenter,y:Math.sin(e)*t+this.yCenter}},draw:function(){if(this.display){var i=this.ctx;if(o(this.yLabels,function(t,e){if(e>0){var n,o=e*(this.drawingArea/this.steps),a=this.yCenter-o;if(this.lineWidth>0)if(i.strokeStyle=this.lineColor,i.lineWidth=this.lineWidth,this.lineArc)i.beginPath(),i.arc(this.xCenter,this.yCenter,o,0,2*Math.PI),i.closePath(),i.stroke();else{i.beginPath();for(var s=0;s<this.valuesCount;s++)n=this.getPointPosition(s,this.calculateCenterOffset(this.min+e*this.stepValue)),0===s?i.moveTo(n.x,n.y):i.lineTo(n.x,n.y);i.closePath(),i.stroke()}if(this.showLabels){if(i.font=W(this.fontSize,this.fontStyle,this.fontFamily),this.showLabelBackdrop){var d=i.measureText(t).width;i.fillStyle=this.backdropColor,i.fillRect(this.xCenter-d/2-this.backdropPaddingX,a-this.fontSize/2-this.backdropPaddingY,d+2*this.backdropPaddingX,this.fontSize+2*this.backdropPaddingY)}i.textAlign="center",i.textBaseline="middle",i.fillStyle=this.fontColor,i.fillText(t,this.xCenter,a)}}},this),!this.lineArc){i.lineWidth=this.angleLineWidth,i.strokeStyle=this.angleLineColor;for(var t=this.valuesCount-1;t>=0;t--){var e=null,n=null;if(this.angleLineWidth>0&&(e=this.calculateCenterOffset(this.max),n=this.getPointPosition(t,e),i.beginPath(),i.moveTo(this.xCenter,this.yCenter),i.lineTo(n.x,n.y),i.stroke(),i.closePath()),this.backgroundColors&&this.backgroundColors.length==this.valuesCount){null==e&&(e=this.calculateCenterOffset(this.max)),null==n&&(n=this.getPointPosition(t,e));var a=this.getPointPosition(0===t?this.valuesCount-1:t-1,e),s=this.getPointPosition(t===this.valuesCount-1?0:t+1,e),d={x:(a.x+n.x)/2,y:(a.y+n.y)/2},l={x:(n.x+s.x)/2,y:(n.y+s.y)/2};i.beginPath(),i.moveTo(this.xCenter,this.yCenter),i.lineTo(d.x,d.y),i.lineTo(n.x,n.y),i.lineTo(l.x,l.y),i.fillStyle=this.backgroundColors[t],i.fill(),i.closePath()}var r=this.getPointPosition(t,this.calculateCenterOffset(this.max)+5);i.font=W(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily),i.fillStyle=this.pointLabelFontColor;var c=this.labels.length,h=this.labels.length/2,g=h/2,u=g>t||t>c-g,p=t===g||t===c-g;0===t?i.textAlign="center":t===h?i.textAlign="center":h>t?i.textAlign="left":i.textAlign="right",p?i.textBaseline="middle":u?i.textBaseline="bottom":i.textBaseline="top",i.fillText(this.labels[t],r.x,r.y)}}}}}),e.animationService={frameDuration:17,animations:[],dropFrames:0,addAnimation:function(i,t){for(var e=0;e<this.animations.length;++e)if(this.animations[e].chartInstance===i)return void(this.animations[e].animationObject=t);this.animations.push({chartInstance:i,animationObject:t}),1==this.animations.length&&n.requestAnimFrame.call(window,this.digestWrapper)},cancelAnimation:function(i){var t=n.findNextWhere(this.animations,function(t){return t.chartInstance===i});t&&this.animations.splice(t,1)},digestWrapper:function(){e.animationService.startDigest.call(e.animationService)},startDigest:function(){var i=Date.now(),t=0;this.dropFrames>1&&(t=Math.floor(this.dropFrames),this.dropFrames-=t);for(var e=0;e<this.animations.length;e++)null===this.animations[e].animationObject.currentStep&&(this.animations[e].animationObject.currentStep=0),this.animations[e].animationObject.currentStep+=1+t,this.animations[e].animationObject.currentStep>this.animations[e].animationObject.numSteps&&(this.animations[e].animationObject.currentStep=this.animations[e].animationObject.numSteps),this.animations[e].animationObject.render(this.animations[e].chartInstance,this.animations[e].animationObject),this.animations[e].animationObject.currentStep==this.animations[e].animationObject.numSteps&&(this.animations[e].animationObject.onAnimationComplete.call(this.animations[e].chartInstance),this.animations.splice(e,1),e--);var o=Date.now(),a=o-i-this.frameDuration,s=a/this.frameDuration;s>1&&(this.dropFrames+=s),this.animations.length>0&&n.requestAnimFrame.call(window,this.digestWrapper)}},n.addEvent(window,"resize",function(){var i;return function(){clearTimeout(i),i=setTimeout(function(){o(e.instances,function(i){i.options.responsive&&i.resize(i.render,!0)})},50)}}()),u?define(function(){return e}):"object"==typeof module&&module.exports&&(module.exports=e),i.Chart=e,e.noConflict=function(){return i.Chart=t,e}}).call(this),function(){"use strict";var i=this,t=i.Chart,e=t.helpers,n={scaleBeginAtZero:!0,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].fillColor%>"><%if(datasets[i].label){%><%=datasets[i].label%><%}%></span></li><%}%></ul>'};t.Type.extend({name:"Bar",defaults:n,initialize:function(i){var n=this.options;this.ScaleClass=t.Scale.extend({offsetGridLines:!0,calculateBarX:function(i,t,e){var o=this.calculateBaseWidth(),a=this.calculateX(e)-o/2,s=this.calculateBarWidth(i);return a+s*t+t*n.barDatasetSpacing+s/2},calculateBaseWidth:function(){return this.calculateX(1)-this.calculateX(0)-2*n.barValueSpacing},calculateBarWidth:function(i){var t=this.calculateBaseWidth()-(i-1)*n.barDatasetSpacing;return t/i}}),this.datasets=[],this.options.showTooltips&&e.bindEvents(this,this.options.tooltipEvents,function(i){var t="mouseout"!==i.type?this.getBarsAtEvent(i):[];this.eachBars(function(i){i.restore(["fillColor","strokeColor"])}),e.each(t,function(i){i.fillColor=i.highlightFill,i.strokeColor=i.highlightStroke}),this.showTooltip(t)}),this.BarClass=t.Rectangle.extend({strokeWidth:this.options.barStrokeWidth,showStroke:this.options.barShowStroke,ctx:this.chart.ctx}),e.each(i.datasets,function(t,n){var o={label:t.label||null,fillColor:t.fillColor,strokeColor:t.strokeColor,bars:[]};this.datasets.push(o),e.each(t.data,function(e,n){o.bars.push(new this.BarClass({value:e,label:i.labels[n],datasetLabel:t.label,strokeColor:t.strokeColor,fillColor:t.fillColor,highlightFill:t.highlightFill||t.fillColor,highlightStroke:t.highlightStroke||t.strokeColor}))},this)},this),this.buildScale(i.labels),this.BarClass.prototype.base=this.scale.endPoint,this.eachBars(function(i,t,n){e.extend(i,{width:this.scale.calculateBarWidth(this.datasets.length),x:this.scale.calculateBarX(this.datasets.length,n,t),y:this.scale.endPoint}),i.save()},this),this.render()},update:function(){this.scale.update(),e.each(this.activeElements,function(i){i.restore(["fillColor","strokeColor"])}),this.eachBars(function(i){i.save()}),this.render()},eachBars:function(i){e.each(this.datasets,function(t,n){e.each(t.bars,i,this,n)},this)},getBarsAtEvent:function(i){for(var t,n=[],o=e.getRelativePosition(i),a=function(i){n.push(i.bars[t])},s=0;s<this.datasets.length;s++)for(t=0;t<this.datasets[s].bars.length;t++)if(this.datasets[s].bars[t].inRange(o.x,o.y))return e.each(this.datasets,a),n;return n},buildScale:function(i){var t=this,n=function(){var i=[];return t.eachBars(function(t){i.push(t.value)}),i},o={templateString:this.options.scaleLabel,height:this.chart.height,width:this.chart.width,ctx:this.chart.ctx,textColor:this.options.scaleFontColor,fontSize:this.options.scaleFontSize,fontStyle:this.options.scaleFontStyle,fontFamily:this.options.scaleFontFamily,valuesCount:i.length,beginAtZero:this.options.scaleBeginAtZero,integersOnly:this.options.scaleIntegersOnly,
calculateYRange:function(i){var t=e.calculateScaleRange(n(),i,this.fontSize,this.beginAtZero,this.integersOnly);e.extend(this,t)},xLabels:i,font:e.fontString(this.options.scaleFontSize,this.options.scaleFontStyle,this.options.scaleFontFamily),lineWidth:this.options.scaleLineWidth,lineColor:this.options.scaleLineColor,showHorizontalLines:this.options.scaleShowHorizontalLines,showVerticalLines:this.options.scaleShowVerticalLines,gridLineWidth:this.options.scaleShowGridLines?this.options.scaleGridLineWidth:0,gridLineColor:this.options.scaleShowGridLines?this.options.scaleGridLineColor:"rgba(0,0,0,0)",padding:this.options.showScale?0:this.options.barShowStroke?this.options.barStrokeWidth:0,showLabels:this.options.scaleShowLabels,display:this.options.showScale};this.options.scaleOverride&&e.extend(o,{calculateYRange:e.noop,steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}),this.scale=new this.ScaleClass(o)},addData:function(i,t){e.each(i,function(i,e){this.datasets[e].bars.push(new this.BarClass({value:i,label:t,datasetLabel:this.datasets[e].label,x:this.scale.calculateBarX(this.datasets.length,e,this.scale.valuesCount+1),y:this.scale.endPoint,width:this.scale.calculateBarWidth(this.datasets.length),base:this.scale.endPoint,strokeColor:this.datasets[e].strokeColor,fillColor:this.datasets[e].fillColor}))},this),this.scale.addXLabel(t),this.update()},removeData:function(){this.scale.removeXLabel(),e.each(this.datasets,function(i){i.bars.shift()},this),this.update()},reflow:function(){e.extend(this.BarClass.prototype,{y:this.scale.endPoint,base:this.scale.endPoint});var i=e.extend({height:this.chart.height,width:this.chart.width});this.scale.update(i)},draw:function(i){var t=i||1;this.clear(),this.chart.ctx,this.scale.draw(t),e.each(this.datasets,function(i,n){e.each(i.bars,function(i,e){i.hasValue()&&(i.base=this.scale.endPoint,i.transition({x:this.scale.calculateBarX(this.datasets.length,n,e),y:this.scale.calculateY(i.value),width:this.scale.calculateBarWidth(this.datasets.length)},t).draw())},this)},this)}})}.call(this),function(){"use strict";var i=this,t=i.Chart,e=t.helpers,n={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,percentageInnerCutout:50,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"><%if(segments[i].label){%><%=segments[i].label%><%}%></span></li><%}%></ul>'};t.Type.extend({name:"Doughnut",defaults:n,initialize:function(i){this.segments=[],this.outerRadius=(e.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2,this.SegmentArc=t.Arc.extend({ctx:this.chart.ctx,x:this.chart.width/2,y:this.chart.height/2}),this.options.showTooltips&&e.bindEvents(this,this.options.tooltipEvents,function(i){var t="mouseout"!==i.type?this.getSegmentsAtEvent(i):[];e.each(this.segments,function(i){i.restore(["fillColor"])}),e.each(t,function(i){i.fillColor=i.highlightColor}),this.showTooltip(t)}),this.calculateTotal(i),e.each(i,function(t,e){t.color||(t.color="hsl("+360*e/i.length+", 100%, 50%)"),this.addData(t,e,!0)},this),this.render()},getSegmentsAtEvent:function(i){var t=[],n=e.getRelativePosition(i);return e.each(this.segments,function(i){i.inRange(n.x,n.y)&&t.push(i)},this),t},addData:function(i,e,n){var o=void 0!==e?e:this.segments.length;"undefined"==typeof i.color&&(i.color=t.defaults.global.segmentColorDefault[o%t.defaults.global.segmentColorDefault.length],i.highlight=t.defaults.global.segmentHighlightColorDefaults[o%t.defaults.global.segmentHighlightColorDefaults.length]),this.segments.splice(o,0,new this.SegmentArc({value:i.value,outerRadius:this.options.animateScale?0:this.outerRadius,innerRadius:this.options.animateScale?0:this.outerRadius/100*this.options.percentageInnerCutout,fillColor:i.color,highlightColor:i.highlight||i.color,showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,startAngle:1.5*Math.PI,circumference:this.options.animateRotate?0:this.calculateCircumference(i.value),label:i.label})),n||(this.reflow(),this.update())},calculateCircumference:function(i){return this.total>0?2*Math.PI*(i/this.total):0},calculateTotal:function(i){this.total=0,e.each(i,function(i){this.total+=Math.abs(i.value)},this)},update:function(){this.calculateTotal(this.segments),e.each(this.activeElements,function(i){i.restore(["fillColor"])}),e.each(this.segments,function(i){i.save()}),this.render()},removeData:function(i){var t=e.isNumber(i)?i:this.segments.length-1;this.segments.splice(t,1),this.reflow(),this.update()},reflow:function(){e.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2}),this.outerRadius=(e.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2,e.each(this.segments,function(i){i.update({outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout})},this)},draw:function(i){var t=i?i:1;this.clear(),e.each(this.segments,function(i,e){i.transition({circumference:this.calculateCircumference(i.value),outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout},t),i.endAngle=i.startAngle+i.circumference,i.draw(),0===e&&(i.startAngle=1.5*Math.PI),e<this.segments.length-1&&(this.segments[e+1].startAngle=i.endAngle)},this)}}),t.types.Doughnut.extend({name:"Pie",defaults:e.merge(n,{percentageInnerCutout:0})})}.call(this),function(){"use strict";var i=this,t=i.Chart,e=t.helpers,n={scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,bezierCurve:!0,bezierCurveTension:.4,pointDot:!0,pointDotRadius:4,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"><%if(datasets[i].label){%><%=datasets[i].label%><%}%></span></li><%}%></ul>',offsetGridLines:!1};t.Type.extend({name:"Line",defaults:n,initialize:function(i){this.PointClass=t.Point.extend({offsetGridLines:this.options.offsetGridLines,strokeWidth:this.options.pointDotStrokeWidth,radius:this.options.pointDotRadius,display:this.options.pointDot,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx,inRange:function(i){return Math.pow(i-this.x,2)<Math.pow(this.radius+this.hitDetectionRadius,2)}}),this.datasets=[],this.options.showTooltips&&e.bindEvents(this,this.options.tooltipEvents,function(i){var t="mouseout"!==i.type?this.getPointsAtEvent(i):[];this.eachPoints(function(i){i.restore(["fillColor","strokeColor"])}),e.each(t,function(i){i.fillColor=i.highlightFill,i.strokeColor=i.highlightStroke}),this.showTooltip(t)}),e.each(i.datasets,function(t){var n={label:t.label||null,fillColor:t.fillColor,strokeColor:t.strokeColor,pointColor:t.pointColor,pointStrokeColor:t.pointStrokeColor,points:[]};this.datasets.push(n),e.each(t.data,function(e,o){n.points.push(new this.PointClass({value:e,label:i.labels[o],datasetLabel:t.label,strokeColor:t.pointStrokeColor,fillColor:t.pointColor,highlightFill:t.pointHighlightFill||t.pointColor,highlightStroke:t.pointHighlightStroke||t.pointStrokeColor}))},this),this.buildScale(i.labels),this.eachPoints(function(i,t){e.extend(i,{x:this.scale.calculateX(t),y:this.scale.endPoint}),i.save()},this)},this),this.render()},update:function(){this.scale.update(),e.each(this.activeElements,function(i){i.restore(["fillColor","strokeColor"])}),this.eachPoints(function(i){i.save()}),this.render()},eachPoints:function(i){e.each(this.datasets,function(t){e.each(t.points,i,this)},this)},getPointsAtEvent:function(i){var t=[],n=e.getRelativePosition(i);return e.each(this.datasets,function(i){e.each(i.points,function(i){i.inRange(n.x,n.y)&&t.push(i)})},this),t},buildScale:function(i){var n=this,o=function(){var i=[];return n.eachPoints(function(t){i.push(t.value)}),i},a={templateString:this.options.scaleLabel,height:this.chart.height,width:this.chart.width,ctx:this.chart.ctx,textColor:this.options.scaleFontColor,offsetGridLines:this.options.offsetGridLines,fontSize:this.options.scaleFontSize,fontStyle:this.options.scaleFontStyle,fontFamily:this.options.scaleFontFamily,valuesCount:i.length,beginAtZero:this.options.scaleBeginAtZero,integersOnly:this.options.scaleIntegersOnly,calculateYRange:function(i){var t=e.calculateScaleRange(o(),i,this.fontSize,this.beginAtZero,this.integersOnly);e.extend(this,t)},xLabels:i,font:e.fontString(this.options.scaleFontSize,this.options.scaleFontStyle,this.options.scaleFontFamily),lineWidth:this.options.scaleLineWidth,lineColor:this.options.scaleLineColor,showHorizontalLines:this.options.scaleShowHorizontalLines,showVerticalLines:this.options.scaleShowVerticalLines,gridLineWidth:this.options.scaleShowGridLines?this.options.scaleGridLineWidth:0,gridLineColor:this.options.scaleShowGridLines?this.options.scaleGridLineColor:"rgba(0,0,0,0)",padding:this.options.showScale?0:this.options.pointDotRadius+this.options.pointDotStrokeWidth,showLabels:this.options.scaleShowLabels,display:this.options.showScale};this.options.scaleOverride&&e.extend(a,{calculateYRange:e.noop,steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}),this.scale=new t.Scale(a)},addData:function(i,t){e.each(i,function(i,e){this.datasets[e].points.push(new this.PointClass({value:i,label:t,datasetLabel:this.datasets[e].label,x:this.scale.calculateX(this.scale.valuesCount+1),y:this.scale.endPoint,strokeColor:this.datasets[e].pointStrokeColor,fillColor:this.datasets[e].pointColor}))},this),this.scale.addXLabel(t),this.update()},removeData:function(){this.scale.removeXLabel(),e.each(this.datasets,function(i){i.points.shift()},this),this.update()},reflow:function(){var i=e.extend({height:this.chart.height,width:this.chart.width});this.scale.update(i)},draw:function(i){var t=i||1;this.clear();var n=this.chart.ctx,o=function(i){return null!==i.value},a=function(i,t,n){return e.findNextWhere(t,o,n)||i},s=function(i,t,n){return e.findPreviousWhere(t,o,n)||i};this.scale&&(this.scale.draw(t),e.each(this.datasets,function(i){var d=e.where(i.points,o);e.each(i.points,function(i,e){i.hasValue()&&i.transition({y:this.scale.calculateY(i.value),x:this.scale.calculateX(e)},t)},this),this.options.bezierCurve&&e.each(d,function(i,t){var n=t>0&&t<d.length-1?this.options.bezierCurveTension:0;i.controlPoints=e.splineCurve(s(i,d,t),i,a(i,d,t),n),i.controlPoints.outer.y>this.scale.endPoint?i.controlPoints.outer.y=this.scale.endPoint:i.controlPoints.outer.y<this.scale.startPoint&&(i.controlPoints.outer.y=this.scale.startPoint),i.controlPoints.inner.y>this.scale.endPoint?i.controlPoints.inner.y=this.scale.endPoint:i.controlPoints.inner.y<this.scale.startPoint&&(i.controlPoints.inner.y=this.scale.startPoint)},this),n.lineWidth=this.options.datasetStrokeWidth,n.strokeStyle=i.strokeColor,n.beginPath(),e.each(d,function(i,t){if(0===t)n.moveTo(i.x,i.y);else if(this.options.bezierCurve){var e=s(i,d,t);n.bezierCurveTo(e.controlPoints.outer.x,e.controlPoints.outer.y,i.controlPoints.inner.x,i.controlPoints.inner.y,i.x,i.y)}else n.lineTo(i.x,i.y)},this),this.options.datasetStroke&&n.stroke(),this.options.datasetFill&&d.length>0&&(n.lineTo(d[d.length-1].x,this.scale.endPoint),n.lineTo(d[0].x,this.scale.endPoint),n.fillStyle=i.fillColor,n.closePath(),n.fill()),e.each(d,function(i){i.draw()})},this))}})}.call(this),function(){"use strict";var i=this,t=i.Chart,e=t.helpers,n={scaleShowLabelBackdrop:!0,scaleBackdropColor:"rgba(255,255,255,0.75)",scaleBeginAtZero:!0,scaleBackdropPaddingY:2,scaleBackdropPaddingX:2,scaleShowLine:!0,segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"><%if(segments[i].label){%><%=segments[i].label%><%}%></span></li><%}%></ul>'};t.Type.extend({name:"PolarArea",defaults:n,initialize:function(i){this.segments=[],this.SegmentArc=t.Arc.extend({showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,ctx:this.chart.ctx,innerRadius:0,x:this.chart.width/2,y:this.chart.height/2}),this.scale=new t.RadialScale({display:this.options.showScale,fontStyle:this.options.scaleFontStyle,fontSize:this.options.scaleFontSize,fontFamily:this.options.scaleFontFamily,fontColor:this.options.scaleFontColor,showLabels:this.options.scaleShowLabels,showLabelBackdrop:this.options.scaleShowLabelBackdrop,backdropColor:this.options.scaleBackdropColor,backdropPaddingY:this.options.scaleBackdropPaddingY,backdropPaddingX:this.options.scaleBackdropPaddingX,lineWidth:this.options.scaleShowLine?this.options.scaleLineWidth:0,lineColor:this.options.scaleLineColor,lineArc:!0,width:this.chart.width,height:this.chart.height,xCenter:this.chart.width/2,yCenter:this.chart.height/2,ctx:this.chart.ctx,templateString:this.options.scaleLabel,valuesCount:i.length}),this.updateScaleRange(i),this.scale.update(),e.each(i,function(i,t){this.addData(i,t,!0)},this),this.options.showTooltips&&e.bindEvents(this,this.options.tooltipEvents,function(i){var t="mouseout"!==i.type?this.getSegmentsAtEvent(i):[];e.each(this.segments,function(i){i.restore(["fillColor"])}),e.each(t,function(i){i.fillColor=i.highlightColor}),this.showTooltip(t)}),this.render()},getSegmentsAtEvent:function(i){var t=[],n=e.getRelativePosition(i);return e.each(this.segments,function(i){i.inRange(n.x,n.y)&&t.push(i)},this),t},addData:function(i,t,e){var n=t||this.segments.length;this.segments.splice(n,0,new this.SegmentArc({fillColor:i.color,highlightColor:i.highlight||i.color,label:i.label,value:i.value,outerRadius:this.options.animateScale?0:this.scale.calculateCenterOffset(i.value),circumference:this.options.animateRotate?0:this.scale.getCircumference(),startAngle:1.5*Math.PI})),e||(this.reflow(),this.update())},removeData:function(i){var t=e.isNumber(i)?i:this.segments.length-1;this.segments.splice(t,1),this.reflow(),this.update()},calculateTotal:function(i){this.total=0,e.each(i,function(i){this.total+=i.value},this),this.scale.valuesCount=this.segments.length},updateScaleRange:function(i){var t=[];e.each(i,function(i){t.push(i.value)});var n=this.options.scaleOverride?{steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}:e.calculateScaleRange(t,e.min([this.chart.width,this.chart.height])/2,this.options.scaleFontSize,this.options.scaleBeginAtZero,this.options.scaleIntegersOnly);e.extend(this.scale,n,{size:e.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2})},update:function(){this.calculateTotal(this.segments),e.each(this.segments,function(i){i.save()}),this.reflow(),this.render()},reflow:function(){e.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2}),this.updateScaleRange(this.segments),this.scale.update(),e.extend(this.scale,{xCenter:this.chart.width/2,yCenter:this.chart.height/2}),e.each(this.segments,function(i){i.update({outerRadius:this.scale.calculateCenterOffset(i.value)})},this)},draw:function(i){var t=i||1;this.clear(),e.each(this.segments,function(i,e){i.transition({circumference:this.scale.getCircumference(),outerRadius:this.scale.calculateCenterOffset(i.value)},t),i.endAngle=i.startAngle+i.circumference,0===e&&(i.startAngle=1.5*Math.PI),e<this.segments.length-1&&(this.segments[e+1].startAngle=i.endAngle),i.draw()},this),this.scale.draw()}})}.call(this),function(){"use strict";var i=this,t=i.Chart,e=t.helpers;t.Type.extend({name:"Radar",defaults:{scaleShowLine:!0,angleShowLineOut:!0,scaleShowLabels:!1,scaleBeginAtZero:!0,angleLineColor:"rgba(0,0,0,.1)",angleLineWidth:1,pointLabelFontFamily:"'Arial'",pointLabelFontStyle:"normal",pointLabelFontSize:10,pointLabelFontColor:"#666",pointDot:!0,pointDotRadius:3,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"><%if(datasets[i].label){%><%=datasets[i].label%><%}%></span></li><%}%></ul>'},initialize:function(i){this.PointClass=t.Point.extend({strokeWidth:this.options.pointDotStrokeWidth,radius:this.options.pointDotRadius,display:this.options.pointDot,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx}),this.datasets=[],this.buildScale(i),this.options.showTooltips&&e.bindEvents(this,this.options.tooltipEvents,function(i){var t="mouseout"!==i.type?this.getPointsAtEvent(i):[];this.eachPoints(function(i){i.restore(["fillColor","strokeColor"])}),e.each(t,function(i){i.fillColor=i.highlightFill,i.strokeColor=i.highlightStroke}),this.showTooltip(t)}),e.each(i.datasets,function(t){var n={label:t.label||null,fillColor:t.fillColor,strokeColor:t.strokeColor,pointColor:t.pointColor,pointStrokeColor:t.pointStrokeColor,points:[]};this.datasets.push(n),e.each(t.data,function(e,o){var a;this.scale.animation||(a=this.scale.getPointPosition(o,this.scale.calculateCenterOffset(e))),n.points.push(new this.PointClass({value:e,label:i.labels[o],datasetLabel:t.label,x:this.options.animation?this.scale.xCenter:a.x,y:this.options.animation?this.scale.yCenter:a.y,strokeColor:t.pointStrokeColor,fillColor:t.pointColor,highlightFill:t.pointHighlightFill||t.pointColor,highlightStroke:t.pointHighlightStroke||t.pointStrokeColor}))},this)},this),this.render()},eachPoints:function(i){e.each(this.datasets,function(t){e.each(t.points,i,this)},this)},getPointsAtEvent:function(i){var t=e.getRelativePosition(i),n=e.getAngleFromPoint({x:this.scale.xCenter,y:this.scale.yCenter},t),o=2*Math.PI/this.scale.valuesCount,a=Math.round((n.angle-1.5*Math.PI)/o),s=[];return(a>=this.scale.valuesCount||0>a)&&(a=0),n.distance<=this.scale.drawingArea&&e.each(this.datasets,function(i){s.push(i.points[a])}),s},buildScale:function(i){this.scale=new t.RadialScale({display:this.options.showScale,fontStyle:this.options.scaleFontStyle,fontSize:this.options.scaleFontSize,fontFamily:this.options.scaleFontFamily,fontColor:this.options.scaleFontColor,showLabels:this.options.scaleShowLabels,showLabelBackdrop:this.options.scaleShowLabelBackdrop,backdropColor:this.options.scaleBackdropColor,backgroundColors:this.options.scaleBackgroundColors,backdropPaddingY:this.options.scaleBackdropPaddingY,backdropPaddingX:this.options.scaleBackdropPaddingX,lineWidth:this.options.scaleShowLine?this.options.scaleLineWidth:0,lineColor:this.options.scaleLineColor,angleLineColor:this.options.angleLineColor,angleLineWidth:this.options.angleShowLineOut?this.options.angleLineWidth:0,pointLabelFontColor:this.options.pointLabelFontColor,pointLabelFontSize:this.options.pointLabelFontSize,pointLabelFontFamily:this.options.pointLabelFontFamily,pointLabelFontStyle:this.options.pointLabelFontStyle,height:this.chart.height,width:this.chart.width,xCenter:this.chart.width/2,yCenter:this.chart.height/2,ctx:this.chart.ctx,templateString:this.options.scaleLabel,labels:i.labels,valuesCount:i.datasets[0].data.length}),this.scale.setScaleSize(),this.updateScaleRange(i.datasets),this.scale.buildYLabels()},updateScaleRange:function(i){var t=function(){var t=[];return e.each(i,function(i){i.data?t=t.concat(i.data):e.each(i.points,function(i){t.push(i.value)})}),t}(),n=this.options.scaleOverride?{steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}:e.calculateScaleRange(t,e.min([this.chart.width,this.chart.height])/2,this.options.scaleFontSize,this.options.scaleBeginAtZero,this.options.scaleIntegersOnly);e.extend(this.scale,n)},addData:function(i,t){this.scale.valuesCount++,e.each(i,function(i,e){var n=this.scale.getPointPosition(this.scale.valuesCount,this.scale.calculateCenterOffset(i));this.datasets[e].points.push(new this.PointClass({value:i,label:t,datasetLabel:this.datasets[e].label,x:n.x,y:n.y,strokeColor:this.datasets[e].pointStrokeColor,fillColor:this.datasets[e].pointColor}))},this),this.scale.labels.push(t),this.reflow(),this.update()},removeData:function(){this.scale.valuesCount--,this.scale.labels.shift(),e.each(this.datasets,function(i){i.points.shift()},this),this.reflow(),this.update()},update:function(){this.eachPoints(function(i){i.save()}),this.reflow(),this.render()},reflow:function(){e.extend(this.scale,{width:this.chart.width,height:this.chart.height,size:e.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2}),this.updateScaleRange(this.datasets),this.scale.setScaleSize(),this.scale.buildYLabels()},draw:function(i){var t=i||1,n=this.chart.ctx;this.clear(),this.scale.draw(),e.each(this.datasets,function(i){e.each(i.points,function(i,e){i.hasValue()&&i.transition(this.scale.getPointPosition(e,this.scale.calculateCenterOffset(i.value)),t)},this),n.lineWidth=this.options.datasetStrokeWidth,n.strokeStyle=i.strokeColor,n.beginPath(),e.each(i.points,function(i,t){0===t?n.moveTo(i.x,i.y):n.lineTo(i.x,i.y)},this),n.closePath(),n.stroke(),n.fillStyle=i.fillColor,this.options.datasetFill&&n.fill(),e.each(i.points,function(i){i.hasValue()&&i.draw()})},this)}})}.call(this);